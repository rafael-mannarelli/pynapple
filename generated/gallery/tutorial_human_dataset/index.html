
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../tutorial_HD_dataset/">
      
      
        <link rel="next" href="../tutorial_pynapple_process/">
      
      
      <link rel="icon" href="../../../images/Icon/Pynapple_final_icon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.8">
    
    
      
        <title>Zheng et al (2022) Dataset Tutorial - pynapple</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.4b4a2bd9.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
      <link rel="stylesheet" href="../../../sg_gallery-dataframe.css">
    
      <link rel="stylesheet" href="../../../sg_gallery.css">
    
      <link rel="stylesheet" href="../../../sg_gallery-rendered-html.css">
    
      <link rel="stylesheet" href="../../../sg_gallery-binder.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#zheng-et-al-2022-dataset-tutorial" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="pynapple" class="md-header__button md-logo" aria-label="pynapple" data-md-component="logo">
      
  <img src="../../../images/Icon/Pynapple_final_icon_2.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            pynapple
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Zheng et al (2022) Dataset Tutorial
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/pynapple-org/pynapple" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="pynapple" class="md-nav__button md-logo" aria-label="pynapple" data-md-component="logo">
      
  <img src="../../../images/Icon/Pynapple_final_icon_2.png" alt="logo">

    </a>
    pynapple
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/pynapple-org/pynapple" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Usage
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial_pynapple_io/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IO Tutorial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial_pynapple_numpy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Numpy tutorial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial_calcium_imaging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Calcium Imaging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial_pynapple_dandi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Streaming data from DANDI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial_pynapple_core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Core Tutorial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial_pynapple_quick_start/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick start
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial_HD_dataset/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Peyrache et al (2015) Tutorial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Zheng et al (2022) Dataset Tutorial
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Zheng et al (2022) Dataset Tutorial
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#stream-the-data-from-dandi" class="md-nav__link">
    Stream the data from DANDI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parsing-the-data" class="md-nav__link">
    Parsing the data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#peri-event-time-histogram-peth" class="md-nav__link">
    Peri-Event Time Histogram (PETH)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#peth-of-firing-rate-for-nb-and-hb-cells" class="md-nav__link">
    PETH of firing rate for NB and HB cells
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial_pynapple_process/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Advanced processing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
          
        
      
        
          
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../reference/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Modules
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../reference/core/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Core
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/core/base_class/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Base class
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/core/config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/core/interval_set/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interval set
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/core/time_index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Time index
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/core/time_series/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Time series
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/core/ts_group/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ts group
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/core/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../reference/io/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Io
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Io
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/io/cnmfe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cnmfe
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/io/folder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Folder
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/io/interface_npz/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interface npz
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/io/interface_nwb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interface nwb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/io/loader/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Loader
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/io/misc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Misc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/io/neurosuite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Neurosuite
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/io/phy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/io/suite2p/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Suite2p
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../reference/process/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Process
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Process
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/process/correlograms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Correlograms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/process/decoding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Decoding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/process/perievent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Perievent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/process/randomize/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Randomize
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/process/tuning_curves/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tuning curves
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../../CONTRIBUTING/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../../AUTHORS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authors
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../../HISTORY/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    History
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#stream-the-data-from-dandi" class="md-nav__link">
    Stream the data from DANDI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parsing-the-data" class="md-nav__link">
    Parsing the data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#peri-event-time-histogram-peth" class="md-nav__link">
    Peri-Event Time Histogram (PETH)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#peth-of-firing-rate-for-nb-and-hb-cells" class="md-nav__link">
    PETH of firing rate for NB and HB cells
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<!--
 DO NOT EDIT.
 THIS FILE WAS AUTOMATICALLY GENERATED BY mkdocs-gallery.
 TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
 "docs/examples/tutorial_human_dataset.py"
 LINE NUMBERS ARE GIVEN BELOW.
-->

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Click <a href="#download_links">here</a>
to download the full example code</p>
</div>
<h1 id="zheng-et-al-2022-dataset-tutorial">Zheng et al (2022) Dataset Tutorial</h1>
<p>This tutorial demonstrates how we use Pynapple on various publicly available datasets in systems neuroscience to streamline analysis. In this tutorial, we will examine the dataset from <a href="https://www.nature.com/articles/s41593-022-01020-w">Zheng et al (2022)</a>, which was used to generate Figure 4c in the <a href="https://elifesciences.org/reviewed-preprints/85786">publication</a>.</p>
<p>The NWB file for the example used here is provided in <a href="https://github.com/PeyracheLab/pynacollada/tree/main/pynacollada/Pynapple%20Paper%20Figures/Zheng%202022/000207/sub-4">this</a> repository. The entire dataset can be downloaded <a href="https://dandiarchive.org/dandiset/000207/0.220216.0323">here</a>.</p>
<p>See the <a href="https://pynapple-org.github.io/pynapple/">documentation</a> of Pynapple for instructions on installing the package.</p>
<p>This tutorial was made by Dhruv Mehrotra.</p>
<p>First, import the necessary libraries:</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 20-26 -->

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This tutorial uses seaborn and matplotlib for displaying the figure as well as the dandi package</p>
<p>You can install all with <code>pip install matplotlib seaborn dandi dandischema</code></p>
</div>
<p>Now, import the necessary libraries:</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 26-32 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">import</span> <span class="nn">pynapple</span> <span class="k">as</span> <span class="nn">nap</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 33-36 -->

<hr />
<h2 id="stream-the-data-from-dandi">Stream the data from DANDI</h2>
<!-- GENERATED FROM PYTHON SOURCE LINES 36-64 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">from</span> <span class="nn">pynwb</span> <span class="kn">import</span> <span class="n">NWBHDF5IO</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="kn">from</span> <span class="nn">dandi.dandiapi</span> <span class="kn">import</span> <span class="n">DandiAPIClient</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="kn">import</span> <span class="nn">fsspec</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="kn">from</span> <span class="nn">fsspec.implementations.cached</span> <span class="kn">import</span> <span class="n">CachingFileSystem</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="kn">import</span> <span class="nn">h5py</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="c1"># Enter the session ID and path to the file</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="n">dandiset_id</span><span class="p">,</span> <span class="n">filepath</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;000207&quot;</span><span class="p">,</span> <span class="s2">&quot;sub-4/sub-4_ses-4_ecephys.nwb&quot;</span><span class="p">)</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="k">with</span> <span class="n">DandiAPIClient</span><span class="p">()</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>    <span class="n">asset</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_dandiset</span><span class="p">(</span><span class="n">dandiset_id</span><span class="p">,</span> <span class="s2">&quot;draft&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_asset_by_path</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>    <span class="n">s3_url</span> <span class="o">=</span> <span class="n">asset</span><span class="o">.</span><span class="n">get_content_url</span><span class="p">(</span><span class="n">follow_redirects</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">strip_query</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="c1"># first, create a virtual filesystem based on the http protocol</span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="n">fs</span> <span class="o">=</span> <span class="n">fsspec</span><span class="o">.</span><span class="n">filesystem</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)</span>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="c1"># create a cache to save downloaded data to disk (optional)</span>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="n">fs</span> <span class="o">=</span> <span class="n">CachingFileSystem</span><span class="p">(</span>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>    <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span>
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>    <span class="n">cache_storage</span><span class="o">=</span><span class="s2">&quot;nwb-cache&quot;</span><span class="p">,</span>  <span class="c1"># Local folder for the cache</span>
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a><span class="p">)</span>
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>
</span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a><span class="c1"># next, open the file</span>
</span><span id="__span-1-25"><a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a><span class="n">file</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">fs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">s3_url</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">))</span>
</span><span id="__span-1-26"><a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a><span class="n">io</span> <span class="o">=</span> <span class="n">NWBHDF5IO</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">,</span> <span class="n">load_namespaces</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></code></pre></div>
<p class="mkd-glr-script-out">Out:</p>
<div class="language-shell mkd-glr-script-out-disp highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>/home/guillaume/miniconda3/envs/pynapple/lib/python3.11/site-packages/hdmf/spec/namespace.py:531:<span class="w"> </span>UserWarning:<span class="w"> </span>Ignoring<span class="w"> </span>cached<span class="w"> </span>namespace<span class="w"> </span><span class="s1">&#39;hdmf-common&#39;</span><span class="w"> </span>version<span class="w"> </span><span class="m">1</span>.5.0<span class="w"> </span>because<span class="w"> </span>version<span class="w"> </span><span class="m">1</span>.8.0<span class="w"> </span>is<span class="w"> </span>already<span class="w"> </span>loaded.
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">  </span>warn<span class="o">(</span><span class="s2">&quot;Ignoring cached namespace &#39;%s&#39; version %s because version %s is already loaded.&quot;</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>/home/guillaume/miniconda3/envs/pynapple/lib/python3.11/site-packages/hdmf/spec/namespace.py:531:<span class="w"> </span>UserWarning:<span class="w"> </span>Ignoring<span class="w"> </span>cached<span class="w"> </span>namespace<span class="w"> </span><span class="s1">&#39;core&#39;</span><span class="w"> </span>version<span class="w"> </span><span class="m">2</span>.5.0<span class="w"> </span>because<span class="w"> </span>version<span class="w"> </span><span class="m">2</span>.6.0-alpha<span class="w"> </span>is<span class="w"> </span>already<span class="w"> </span>loaded.
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">  </span>warn<span class="o">(</span><span class="s2">&quot;Ignoring cached namespace &#39;%s&#39; version %s because version %s is already loaded.&quot;</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>/home/guillaume/miniconda3/envs/pynapple/lib/python3.11/site-packages/hdmf/spec/namespace.py:531:<span class="w"> </span>UserWarning:<span class="w"> </span>Ignoring<span class="w"> </span>cached<span class="w"> </span>namespace<span class="w"> </span><span class="s1">&#39;hdmf-experimental&#39;</span><span class="w"> </span>version<span class="w"> </span><span class="m">0</span>.1.0<span class="w"> </span>because<span class="w"> </span>version<span class="w"> </span><span class="m">0</span>.5.0<span class="w"> </span>is<span class="w"> </span>already<span class="w"> </span>loaded.
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="w">  </span>warn<span class="o">(</span><span class="s2">&quot;Ignoring cached namespace &#39;%s&#39; version %s because version %s is already loaded.&quot;</span>
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 65-71 -->

<hr />
<h2 id="parsing-the-data">Parsing the data</h2>
<p>The first step is to load the data from the Neurodata Without Borders (NWB) file. This is done as follows:</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 71-80 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">custom_params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;axes.spines.right&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;axes.spines.top&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;ticks&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;colorblind&quot;</span><span class="p">,</span> <span class="n">font_scale</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">rc</span><span class="o">=</span><span class="n">custom_params</span><span class="p">)</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="n">data</span> <span class="o">=</span> <span class="n">nap</span><span class="o">.</span><span class="n">NWBFile</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>  <span class="c1"># Load the NWB file for this dataset</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="c1"># What does this look like?</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></code></pre></div>
<p class="mkd-glr-script-out">Out:</p>
<div class="language-shell mkd-glr-script-out-disp highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="m">4</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>┍━━━━━━━━━━━━━━━━━━━━━━━━━━┯━━━━━━━━━━━━━┑
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>│<span class="w"> </span>Keys<span class="w">                     </span>│<span class="w"> </span>Type<span class="w">        </span>│
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>┝━━━━━━━━━━━━━━━━━━━━━━━━━━┿━━━━━━━━━━━━━┥
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>│<span class="w"> </span>units<span class="w">                    </span>│<span class="w"> </span>TsGroup<span class="w">     </span>│
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>│<span class="w"> </span>timediscrimination_table<span class="w"> </span>│<span class="w"> </span>IntervalSet<span class="w"> </span>│
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>│<span class="w"> </span>recognition_table<span class="w">        </span>│<span class="w"> </span>IntervalSet<span class="w"> </span>│
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>│<span class="w"> </span>encoding_table<span class="w">           </span>│<span class="w"> </span>IntervalSet<span class="w"> </span>│
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>│<span class="w"> </span>experiment_ids<span class="w">           </span>│<span class="w"> </span>Tsd<span class="w">         </span>│
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>│<span class="w"> </span>events<span class="w">                   </span>│<span class="w"> </span>Tsd<span class="w">         </span>│
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>┕━━━━━━━━━━━━━━━━━━━━━━━━━━┷━━━━━━━━━━━━━┙
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 81-82 -->

<p>Get spike timings</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 82-84 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">spikes</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span>
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 85-86 -->

<p>What does this look like?</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 86-88 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="nb">print</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>
</span></code></pre></div>
<p class="mkd-glr-script-out">Out:</p>
<div class="language-shell mkd-glr-script-out-disp highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="w">  </span>Index<span class="w">    </span>rate<span class="w">      </span>x<span class="w">       </span>y<span class="w">       </span>z<span class="w">    </span>imp<span class="w">  </span>location<span class="w">           </span>filtering<span class="w">    </span>group_name<span class="w">      </span>origChannel
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>-------<span class="w">  </span>------<span class="w">  </span>-----<span class="w">  </span>------<span class="w">  </span>------<span class="w">  </span>-----<span class="w">  </span>-----------------<span class="w">  </span>-----------<span class="w">  </span>------------<span class="w">  </span>-------------
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">      </span><span class="m">0</span><span class="w">    </span><span class="m">7</span><span class="w">     </span><span class="m">26</span>.63<span class="w">  </span>-15.83<span class="w">  </span>-16.49<span class="w">    </span>nan<span class="w">  </span>hippocampus_right<span class="w">  </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">139</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">      </span><span class="m">1</span><span class="w">    </span><span class="m">7</span>.24<span class="w">  </span><span class="m">26</span>.63<span class="w">  </span>-15.83<span class="w">  </span>-16.49<span class="w">    </span>nan<span class="w">  </span>hippocampus_right<span class="w">  </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">139</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">      </span><span class="m">2</span><span class="w">    </span><span class="m">6</span>.09<span class="w">  </span><span class="m">26</span>.63<span class="w">  </span>-15.83<span class="w">  </span>-16.49<span class="w">    </span>nan<span class="w">  </span>hippocampus_right<span class="w">  </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">140</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="w">      </span><span class="m">3</span><span class="w">    </span><span class="m">6</span>.92<span class="w">  </span><span class="m">26</span>.63<span class="w">  </span>-15.83<span class="w">  </span>-16.49<span class="w">    </span>nan<span class="w">  </span>hippocampus_right<span class="w">  </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">142</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="w">      </span><span class="m">4</span><span class="w">    </span><span class="m">0</span>.4<span class="w">   </span><span class="m">26</span>.63<span class="w">  </span>-15.83<span class="w">  </span>-16.49<span class="w">    </span>nan<span class="w">  </span>hippocampus_right<span class="w">  </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">142</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="w">      </span><span class="m">5</span><span class="w">    </span><span class="m">0</span>.46<span class="w">  </span><span class="m">26</span>.63<span class="w">  </span>-15.83<span class="w">  </span>-16.49<span class="w">    </span>nan<span class="w">  </span>hippocampus_right<span class="w">  </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">143</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="w">      </span><span class="m">6</span><span class="w">    </span><span class="m">1</span>.81<span class="w">  </span><span class="m">26</span>.63<span class="w">  </span>-15.83<span class="w">  </span>-16.49<span class="w">    </span>nan<span class="w">  </span>hippocampus_right<span class="w">  </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">143</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="w">      </span><span class="m">7</span><span class="w">    </span><span class="m">4</span>.79<span class="w">  </span><span class="m">26</span>.63<span class="w">  </span>-15.83<span class="w">  </span>-16.49<span class="w">    </span>nan<span class="w">  </span>hippocampus_right<span class="w">  </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">144</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="w">      </span><span class="m">8</span><span class="w">    </span><span class="m">1</span>.31<span class="w">  </span><span class="m">21</span>.36<span class="w">   </span>-0.59<span class="w">  </span>-21.55<span class="w">    </span>nan<span class="w">  </span>amygdala_right<span class="w">     </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">154</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="w">      </span><span class="m">9</span><span class="w">    </span><span class="m">0</span>.62<span class="w">  </span><span class="m">21</span>.36<span class="w">   </span>-0.59<span class="w">  </span>-21.55<span class="w">    </span>nan<span class="w">  </span>amygdala_right<span class="w">     </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">156</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="w">     </span><span class="m">10</span><span class="w">    </span><span class="m">1</span>.51<span class="w">  </span><span class="m">21</span>.36<span class="w">   </span>-0.59<span class="w">  </span>-21.55<span class="w">    </span>nan<span class="w">  </span>amygdala_right<span class="w">     </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">157</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="w">     </span><span class="m">11</span><span class="w">    </span><span class="m">0</span>.77<span class="w">  </span><span class="m">21</span>.36<span class="w">   </span>-0.59<span class="w">  </span>-21.55<span class="w">    </span>nan<span class="w">  </span>amygdala_right<span class="w">     </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">157</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="w">     </span><span class="m">12</span><span class="w">    </span><span class="m">1</span>.46<span class="w">  </span><span class="m">21</span>.36<span class="w">   </span>-0.59<span class="w">  </span>-21.55<span class="w">    </span>nan<span class="w">  </span>amygdala_right<span class="w">     </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">158</span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="w">     </span><span class="m">13</span><span class="w">    </span><span class="m">0</span>.4<span class="w">   </span><span class="m">21</span>.36<span class="w">   </span>-0.59<span class="w">  </span>-21.55<span class="w">    </span>nan<span class="w">  </span>amygdala_right<span class="w">     </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">158</span>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a><span class="w">     </span><span class="m">14</span><span class="w">    </span><span class="m">6</span>.27<span class="w">  </span><span class="m">21</span>.36<span class="w">   </span>-0.59<span class="w">  </span>-21.55<span class="w">    </span>nan<span class="w">  </span>amygdala_right<span class="w">     </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">158</span>
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a><span class="w">     </span><span class="m">15</span><span class="w">    </span><span class="m">1</span>.15<span class="w">  </span><span class="m">21</span>.36<span class="w">   </span>-0.59<span class="w">  </span>-21.55<span class="w">    </span>nan<span class="w">  </span>amygdala_right<span class="w">     </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">159</span>
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a><span class="w">     </span><span class="m">16</span><span class="w">    </span><span class="m">2</span>.15<span class="w">  </span><span class="m">21</span>.36<span class="w">   </span>-0.59<span class="w">  </span>-21.55<span class="w">    </span>nan<span class="w">  </span>amygdala_right<span class="w">     </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">159</span>
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a><span class="w">     </span><span class="m">17</span><span class="w">    </span><span class="m">0</span>.63<span class="w">  </span><span class="m">21</span>.36<span class="w">   </span>-0.59<span class="w">  </span>-21.55<span class="w">    </span>nan<span class="w">  </span>amygdala_right<span class="w">     </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">159</span>
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a><span class="w">     </span><span class="m">18</span><span class="w">    </span><span class="m">2</span>.88<span class="w">  </span><span class="m">26</span>.63<span class="w">  </span>-15.83<span class="w">  </span>-16.49<span class="w">    </span>nan<span class="w">  </span>hippocampus_right<span class="w">  </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">184</span>
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a><span class="w">     </span><span class="m">19</span><span class="w">    </span><span class="m">0</span>.35<span class="w">  </span><span class="m">26</span>.63<span class="w">  </span>-15.83<span class="w">  </span>-16.49<span class="w">    </span>nan<span class="w">  </span>hippocampus_right<span class="w">  </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">185</span>
</span><span id="__span-7-23"><a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a><span class="w">     </span><span class="m">20</span><span class="w">    </span><span class="m">1</span>.75<span class="w">  </span><span class="m">26</span>.63<span class="w">  </span>-15.83<span class="w">  </span>-16.49<span class="w">    </span>nan<span class="w">  </span>hippocampus_right<span class="w">  </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">185</span>
</span><span id="__span-7-24"><a id="__codelineno-7-24" name="__codelineno-7-24" href="#__codelineno-7-24"></a><span class="w">     </span><span class="m">21</span><span class="w">    </span><span class="m">0</span>.58<span class="w">  </span><span class="m">26</span>.63<span class="w">  </span>-15.83<span class="w">  </span>-16.49<span class="w">    </span>nan<span class="w">  </span>hippocampus_right<span class="w">  </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">186</span>
</span><span id="__span-7-25"><a id="__codelineno-7-25" name="__codelineno-7-25" href="#__codelineno-7-25"></a><span class="w">     </span><span class="m">22</span><span class="w">    </span><span class="m">2</span>.13<span class="w">  </span><span class="m">26</span>.63<span class="w">  </span>-15.83<span class="w">  </span>-16.49<span class="w">    </span>nan<span class="w">  </span>hippocampus_right<span class="w">  </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">186</span>
</span><span id="__span-7-26"><a id="__codelineno-7-26" name="__codelineno-7-26" href="#__codelineno-7-26"></a><span class="w">     </span><span class="m">23</span><span class="w">    </span><span class="m">1</span>.51<span class="w">  </span><span class="m">26</span>.63<span class="w">  </span>-15.83<span class="w">  </span>-16.49<span class="w">    </span>nan<span class="w">  </span>hippocampus_right<span class="w">  </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">187</span>
</span><span id="__span-7-27"><a id="__codelineno-7-27" name="__codelineno-7-27" href="#__codelineno-7-27"></a><span class="w">     </span><span class="m">24</span><span class="w">    </span><span class="m">0</span>.27<span class="w">  </span><span class="m">26</span>.63<span class="w">  </span>-15.83<span class="w">  </span>-16.49<span class="w">    </span>nan<span class="w">  </span>hippocampus_right<span class="w">  </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">188</span>
</span><span id="__span-7-28"><a id="__codelineno-7-28" name="__codelineno-7-28" href="#__codelineno-7-28"></a><span class="w">     </span><span class="m">25</span><span class="w">    </span><span class="m">7</span>.35<span class="w">  </span><span class="m">26</span>.63<span class="w">  </span>-15.83<span class="w">  </span>-16.49<span class="w">    </span>nan<span class="w">  </span>hippocampus_right<span class="w">  </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">188</span>
</span><span id="__span-7-29"><a id="__codelineno-7-29" name="__codelineno-7-29" href="#__codelineno-7-29"></a><span class="w">     </span><span class="m">26</span><span class="w">    </span><span class="m">0</span>.37<span class="w">  </span><span class="m">26</span>.63<span class="w">  </span>-15.83<span class="w">  </span>-16.49<span class="w">    </span>nan<span class="w">  </span>hippocampus_right<span class="w">  </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">188</span>
</span><span id="__span-7-30"><a id="__codelineno-7-30" name="__codelineno-7-30" href="#__codelineno-7-30"></a><span class="w">     </span><span class="m">27</span><span class="w">    </span><span class="m">1</span>.89<span class="w">  </span><span class="m">26</span>.63<span class="w">  </span>-15.83<span class="w">  </span>-16.49<span class="w">    </span>nan<span class="w">  </span>hippocampus_right<span class="w">  </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">188</span>
</span><span id="__span-7-31"><a id="__codelineno-7-31" name="__codelineno-7-31" href="#__codelineno-7-31"></a><span class="w">     </span><span class="m">28</span><span class="w">    </span><span class="m">1</span>.13<span class="w">  </span><span class="m">26</span>.63<span class="w">  </span>-15.83<span class="w">  </span>-16.49<span class="w">    </span>nan<span class="w">  </span>hippocampus_right<span class="w">  </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">189</span>
</span><span id="__span-7-32"><a id="__codelineno-7-32" name="__codelineno-7-32" href="#__codelineno-7-32"></a><span class="w">     </span><span class="m">29</span><span class="w">    </span><span class="m">0</span>.6<span class="w">   </span><span class="m">26</span>.63<span class="w">  </span>-15.83<span class="w">  </span>-16.49<span class="w">    </span>nan<span class="w">  </span>hippocampus_right<span class="w">  </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">190</span>
</span><span id="__span-7-33"><a id="__codelineno-7-33" name="__codelineno-7-33" href="#__codelineno-7-33"></a><span class="w">     </span><span class="m">30</span><span class="w">    </span><span class="m">0</span>.18<span class="w">  </span><span class="m">26</span>.63<span class="w">  </span>-15.83<span class="w">  </span>-16.49<span class="w">    </span>nan<span class="w">  </span>hippocampus_right<span class="w">  </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">190</span>
</span><span id="__span-7-34"><a id="__codelineno-7-34" name="__codelineno-7-34" href="#__codelineno-7-34"></a><span class="w">     </span><span class="m">31</span><span class="w">    </span><span class="m">2</span>.33<span class="w">  </span><span class="m">26</span>.63<span class="w">  </span>-15.83<span class="w">  </span>-16.49<span class="w">    </span>nan<span class="w">  </span>hippocampus_right<span class="w">  </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">191</span>
</span><span id="__span-7-35"><a id="__codelineno-7-35" name="__codelineno-7-35" href="#__codelineno-7-35"></a><span class="w">     </span><span class="m">32</span><span class="w">    </span><span class="m">0</span>.31<span class="w">  </span><span class="m">26</span>.63<span class="w">  </span>-15.83<span class="w">  </span>-16.49<span class="w">    </span>nan<span class="w">  </span>hippocampus_right<span class="w">  </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">191</span>
</span><span id="__span-7-36"><a id="__codelineno-7-36" name="__codelineno-7-36" href="#__codelineno-7-36"></a><span class="w">     </span><span class="m">33</span><span class="w">    </span><span class="m">0</span>.69<span class="w">  </span><span class="m">26</span>.63<span class="w">  </span>-15.83<span class="w">  </span>-16.49<span class="w">    </span>nan<span class="w">  </span>hippocampus_right<span class="w">  </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">191</span>
</span><span id="__span-7-37"><a id="__codelineno-7-37" name="__codelineno-7-37" href="#__codelineno-7-37"></a><span class="w">     </span><span class="m">34</span><span class="w">    </span><span class="m">0</span>.66<span class="w">  </span><span class="m">26</span>.63<span class="w">  </span>-15.83<span class="w">  </span>-16.49<span class="w">    </span>nan<span class="w">  </span>hippocampus_right<span class="w">  </span><span class="m">300</span>-3000Hz<span class="w">   </span>micros<span class="w">                  </span><span class="m">192</span>
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 89-90 -->

<p>This TsGroup has, among other information, the mean firing rate of the unit, the X, Y and Z coordinates, the brain region the unit was recorded from, and the channel number on which the unit was located.</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 92-93 -->

<p>Next, let's get the encoding table of all stimulus times, as shown below:</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 93-99 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">encoding_table</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;encoding_table&quot;</span><span class="p">]</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="c1"># What does this look like?</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="nb">print</span><span class="p">(</span><span class="n">encoding_table</span><span class="p">)</span>
</span></code></pre></div>
<p class="mkd-glr-script-out">Out:</p>
<div class="language-shell mkd-glr-script-out-disp highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>/home/guillaume/pynapple/pynapple/io/interface_nwb.py:449:<span class="w"> </span>UserWarning:<span class="w"> </span>Too<span class="w"> </span>many<span class="w"> </span>metadata.<span class="w"> </span>Returning<span class="w"> </span>pandas.DataFrame,<span class="w"> </span>not<span class="w"> </span>IntervalSet
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="w">  </span><span class="nv">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>self._f_eval<span class="o">[</span>self.data<span class="o">[</span>key<span class="o">][</span><span class="s2">&quot;type&quot;</span><span class="o">]](</span>obj<span class="o">)</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="w">    </span>start_time<span class="w">   </span>stop_time<span class="w">  </span>fixcross_time<span class="w">  </span>...<span class="w">  </span>boundary3_time<span class="w">  </span>stimCategory<span class="w">  </span>Clip_name
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>id<span class="w">                                         </span>...<span class="w">                                         </span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="m">0</span><span class="w">     </span><span class="m">1</span>.068463<span class="w">    </span><span class="m">9</span>.101330<span class="w">       </span><span class="m">0</span>.056555<span class="w">  </span>...<span class="w">             </span>NaN<span class="w">             </span><span class="m">0</span><span class="w">  </span>NB_24.mp4
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="m">1</span><span class="w">    </span><span class="m">10</span>.182342<span class="w">   </span><span class="m">18</span>.114558<span class="w">       </span><span class="m">9</span>.116686<span class="w">  </span>...<span class="w">             </span>NaN<span class="w">             </span><span class="m">1</span><span class="w">  </span>SB_23.mp4
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="m">2</span><span class="w">    </span><span class="m">19</span>.071072<span class="w">   </span><span class="m">27</span>.137388<span class="w">      </span><span class="m">18</span>.130498<span class="w">  </span>...<span class="w">             </span>NaN<span class="w">             </span><span class="m">2</span><span class="w">  </span>HB_20.mp4
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="m">3</span><span class="w">    </span><span class="m">28</span>.160476<span class="w">   </span><span class="m">36</span>.390234<span class="w">      </span><span class="m">27</span>.154926<span class="w">  </span>...<span class="w">             </span>NaN<span class="w">             </span><span class="m">0</span><span class="w">  </span>NB_26.mp4
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="m">4</span><span class="w">    </span><span class="m">37</span>.470909<span class="w">   </span><span class="m">44</span>.584497<span class="w">      </span><span class="m">36</span>.409347<span class="w">  </span>...<span class="w">             </span>NaN<span class="w">             </span><span class="m">0</span><span class="w">  </span>NB_25.mp4
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>..<span class="w">         </span>...<span class="w">         </span>...<span class="w">            </span>...<span class="w">  </span>...<span class="w">             </span>...<span class="w">           </span>...<span class="w">        </span>...
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="m">85</span><span class="w">  </span><span class="m">892</span>.755233<span class="w">  </span><span class="m">900</span>.921092<span class="w">     </span><span class="m">891</span>.747973<span class="w">  </span>...<span class="w">             </span>NaN<span class="w">             </span><span class="m">1</span><span class="w">   </span>SB_2.mp4
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="m">86</span><span class="w">  </span><span class="m">901</span>.906850<span class="w">  </span><span class="m">910</span>.171979<span class="w">     </span><span class="m">900</span>.940121<span class="w">  </span>...<span class="w">             </span>NaN<span class="w">             </span><span class="m">2</span><span class="w">  </span>HB_27.mp4
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="m">87</span><span class="w">  </span><span class="m">911</span>.138396<span class="w">  </span><span class="m">919</span>.335950<span class="w">     </span><span class="m">910</span>.190938<span class="w">  </span>...<span class="w">      </span><span class="m">917</span>.067151<span class="w">             </span><span class="m">2</span><span class="w">  </span>HB_10.mp4
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="m">88</span><span class="w">  </span><span class="m">920</span>.363950<span class="w">  </span><span class="m">928</span>.329845<span class="w">     </span><span class="m">919</span>.354902<span class="w">  </span>...<span class="w">      </span><span class="m">924</span>.924117<span class="w">             </span><span class="m">1</span><span class="w">  </span>SB_27.mp4
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="m">89</span><span class="w">  </span><span class="m">930</span>.639635<span class="w">  </span><span class="m">939</span>.073029<span class="w">     </span><span class="m">929</span>.718098<span class="w">  </span>...<span class="w">             </span>NaN<span class="w">             </span><span class="m">1</span><span class="w">  </span>SB_25.mp4
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a>
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a><span class="o">[</span><span class="m">90</span><span class="w"> </span>rows<span class="w"> </span>x<span class="w"> </span><span class="m">9</span><span class="w"> </span>columns<span class="o">]</span>
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 100-103 -->

<p>This table has, among other things, the scene boundary times for which we will plot the peri-event time histogram (PETH).</p>
<p>There are 3 types of scene boundaries in this data. For the purposes of demonstration, we will use only the "No boundary" (NB) and the "Hard boundary" (HB conditions). The encoding table has a stimCategory field, which tells us the type of boundary corresponding to a given trial.</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 103-111 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">stimCategory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>    <span class="n">encoding_table</span><span class="o">.</span><span class="n">stimCategory</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="p">)</span>  <span class="c1"># Get the scene boundary type for all trials</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="c1"># What does this look like?</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="nb">print</span><span class="p">(</span><span class="n">stimCategory</span><span class="p">)</span>
</span></code></pre></div>
<p class="mkd-glr-script-out">Out:</p>
<div class="language-shell mkd-glr-script-out-disp highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="o">[</span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="o">]</span>
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 112-113 -->

<p>Trials marked 0 correspond to NB, while trials marked 2 correspond to HB. Let's extract the trial numbers for NB and HB trials, as shown below:</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 113-117 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="n">indxNB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">stimCategory</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># NB trial indices</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="n">indxHB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">stimCategory</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># HB trial indices</span>
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 118-119 -->

<p>The encoding table also has 3 types of boundary times. For the purposes of our demonstration, we will focus on boundary1 times, and extract them as shown below:</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 119-125 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">boundary1_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">encoding_table</span><span class="o">.</span><span class="n">boundary1_time</span><span class="p">)</span>  <span class="c1"># Get timings of Boundary1</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="c1"># What does this look like?</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="nb">print</span><span class="p">(</span><span class="n">boundary1_time</span><span class="p">)</span>
</span></code></pre></div>
<p class="mkd-glr-script-out">Out:</p>
<div class="language-shell mkd-glr-script-out-disp highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="o">[</span><span class="w">  </span><span class="m">5</span>.06846275<span class="w">  </span><span class="m">12</span>.88060075<span class="w">  </span><span class="m">23</span>.071072<span class="w">    </span><span class="m">32</span>.1604755<span class="w">   </span><span class="m">41</span>.470909
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="w">  </span><span class="m">49</span>.5747065<span class="w">   </span><span class="m">56</span>.07442325<span class="w">  </span><span class="m">72</span>.803867<span class="w">    </span><span class="m">82</span>.1299925<span class="w">   </span><span class="m">92</span>.77667275
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="w">  </span><span class="m">99</span>.9925845<span class="w">  </span><span class="m">109</span>.0787315<span class="w">  </span><span class="m">118</span>.0778575<span class="w">  </span><span class="m">133</span>.12435825<span class="w"> </span><span class="m">140</span>.94827125
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="w"> </span><span class="m">147</span>.8236585<span class="w">  </span><span class="m">160</span>.726736<span class="w">   </span><span class="m">170</span>.441769<span class="w">   </span><span class="m">183</span>.29262575<span class="w"> </span><span class="m">191</span>.11327175
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="w"> </span><span class="m">199</span>.63382425<span class="w"> </span><span class="m">208</span>.5142425<span class="w">  </span><span class="m">217</span>.6186295<span class="w">  </span><span class="m">232</span>.62687825<span class="w"> </span><span class="m">241</span>.7270365
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="w"> </span><span class="m">250</span>.58327775<span class="w"> </span><span class="m">259</span>.5545145<span class="w">  </span><span class="m">268</span>.6661045<span class="w">  </span><span class="m">278</span>.026902<span class="w">   </span><span class="m">287</span>.04517875
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="w"> </span><span class="m">301</span>.2426685<span class="w">  </span><span class="m">310</span>.21093375<span class="w"> </span><span class="m">319</span>.1822215<span class="w">  </span><span class="m">328</span>.13037175<span class="w"> </span><span class="m">337</span>.16751875
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="w"> </span><span class="m">363</span>.737004<span class="w">   </span><span class="m">372</span>.785663<span class="w">   </span><span class="m">381</span>.86749625<span class="w"> </span><span class="m">391</span>.2704085<span class="w">  </span><span class="m">400</span>.5077995
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="w"> </span><span class="m">407</span>.28660475<span class="w"> </span><span class="m">416</span>.0272855<span class="w">  </span><span class="m">431</span>.792285<span class="w">   </span><span class="m">441</span>.75272875<span class="w"> </span><span class="m">448</span>.88401175
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="w"> </span><span class="m">456</span>.97766275<span class="w"> </span><span class="m">463</span>.88864475<span class="w"> </span><span class="m">472</span>.13035175<span class="w"> </span><span class="m">490</span>.53584775<span class="w"> </span><span class="m">499</span>.7064625
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="w"> </span><span class="m">507</span>.6917495<span class="w">  </span><span class="m">518</span>.78793775<span class="w"> </span><span class="m">528</span>.140675<span class="w">   </span><span class="m">537</span>.1412335<span class="w">  </span><span class="m">552</span>.5116415
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="w"> </span><span class="m">562</span>.4287995<span class="w">  </span><span class="m">569</span>.44012625<span class="w"> </span><span class="m">580</span>.99649325<span class="w"> </span><span class="m">591</span>.974217<span class="w">   </span><span class="m">597</span>.74463025
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="w"> </span><span class="m">608</span>.3638655<span class="w">  </span><span class="m">624</span>.44389125<span class="w"> </span><span class="m">633</span>.4175285<span class="w">  </span><span class="m">642</span>.3969695<span class="w">  </span><span class="m">651</span>.776966
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a><span class="w"> </span><span class="m">660</span>.699774<span class="w">   </span><span class="m">676</span>.9439885<span class="w">  </span><span class="m">681</span>.3602465<span class="w">  </span><span class="m">692</span>.799878<span class="w">   </span><span class="m">699</span>.53861175
</span><span id="__span-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a><span class="w"> </span><span class="m">711</span>.341688<span class="w">   </span><span class="m">720</span>.4819275<span class="w">  </span><span class="m">729</span>.43782175<span class="w"> </span><span class="m">772</span>.99961425<span class="w"> </span><span class="m">780</span>.19490625
</span><span id="__span-14-16"><a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a><span class="w"> </span><span class="m">788</span>.1175045<span class="w">  </span><span class="m">798</span>.34264525<span class="w"> </span><span class="m">807</span>.54519<span class="w">    </span><span class="m">817</span>.25781375<span class="w"> </span><span class="m">835</span>.1736475
</span><span id="__span-14-17"><a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a><span class="w"> </span><span class="m">842</span>.54760125<span class="w"> </span><span class="m">852</span>.294991<span class="w">   </span><span class="m">861</span>.40924725<span class="w"> </span><span class="m">868</span>.63873425<span class="w"> </span><span class="m">887</span>.93252325
</span><span id="__span-14-18"><a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a><span class="w"> </span><span class="m">898</span>.284193<span class="w">   </span><span class="m">905</span>.9068505<span class="w">  </span><span class="m">915</span>.1383965<span class="w">  </span><span class="m">921</span>.90619325<span class="w"> </span><span class="m">932</span>.99710575<span class="o">]</span>
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 126-127 -->

<p>This contains the timings of all boundaries in this block of trials. Note that we also have the type of boundary for each trial. Let's store the NB and HB boundary timings in separate variables, as Pynapple Ts objects:</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 127-132 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="n">NB</span> <span class="o">=</span> <span class="n">nap</span><span class="o">.</span><span class="n">Ts</span><span class="p">(</span><span class="n">boundary1_time</span><span class="p">[</span><span class="n">indxNB</span><span class="p">])</span>  <span class="c1"># NB timings</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="n">HB</span> <span class="o">=</span> <span class="n">nap</span><span class="o">.</span><span class="n">Ts</span><span class="p">(</span><span class="n">boundary1_time</span><span class="p">[</span><span class="n">indxHB</span><span class="p">])</span>  <span class="c1"># HB timings</span>
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 133-142 -->

<hr />
<h2 id="peri-event-time-histogram-peth">Peri-Event Time Histogram (PETH)</h2>
<p>A PETH is a plot where we align a variable of interest (for example, spikes) to an external event (in this case, to boundary times). This visualization helps us infer relationships between the two.</p>
<p>For our demonstration, we will align the spikes of the first unit, which is located in the hippocampus, to the times of NB and HB. You can do a quick check to verify that the first unit is indeed located in the hippocampus, we leave it to you.</p>
<p>With Pynapple, PETHs can be computed with a single line of code!</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 142-150 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="n">NB_peth</span> <span class="o">=</span> <span class="n">nap</span><span class="o">.</span><span class="n">compute_perievent</span><span class="p">(</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>    <span class="n">spikes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">NB</span><span class="p">,</span> <span class="n">minmax</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="p">)</span>  <span class="c1"># Compute PETH of unit aligned to NB, for -0.5 to 1s windows</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="n">HB_peth</span> <span class="o">=</span> <span class="n">nap</span><span class="o">.</span><span class="n">compute_perievent</span><span class="p">(</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>    <span class="n">spikes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">HB</span><span class="p">,</span> <span class="n">minmax</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="p">)</span>  <span class="c1"># Compute PETH of unit aligned to HB, for -0.5 to 1s windows</span>
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 151-152 -->

<p>Let's plot the PETH</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 152-183 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>  <span class="c1"># Plot the figures in 2 rows</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">NB_peth</span><span class="p">):</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>        <span class="n">NB_peth</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">as_units</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>        <span class="s2">&quot;o&quot;</span><span class="p">,</span>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>        <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="mi">102</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">204</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span> <span class="o">/</span> <span class="mi">255</span><span class="p">],</span>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>        <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>    <span class="p">)</span>  <span class="c1"># Plot PETH</span>
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>  <span class="c1"># Plot a line at t = 0</span>
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">])</span>  <span class="c1"># Set ticks on Y-axis</span>
</span><span id="__span-17-12"><a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;30&quot;</span><span class="p">])</span>  <span class="c1"># Label the ticks</span>
</span><span id="__span-17-13"><a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time from NB (s)&quot;</span><span class="p">)</span>  <span class="c1"># Time from boundary in seconds, on X-axis</span>
</span><span id="__span-17-14"><a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Trial Number&quot;</span><span class="p">)</span>  <span class="c1"># Trial number on Y-axis</span>
</span><span id="__span-17-15"><a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a>
</span><span id="__span-17-16"><a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
</span><span id="__span-17-17"><a id="__codelineno-17-17" name="__codelineno-17-17" href="#__codelineno-17-17"></a><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">HB_peth</span><span class="p">):</span>
</span><span id="__span-17-18"><a id="__codelineno-17-18" name="__codelineno-17-18" href="#__codelineno-17-18"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="__span-17-19"><a id="__codelineno-17-19" name="__codelineno-17-19" href="#__codelineno-17-19"></a>        <span class="n">HB_peth</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">as_units</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
</span><span id="__span-17-20"><a id="__codelineno-17-20" name="__codelineno-17-20" href="#__codelineno-17-20"></a>        <span class="s2">&quot;o&quot;</span><span class="p">,</span>
</span><span id="__span-17-21"><a id="__codelineno-17-21" name="__codelineno-17-21" href="#__codelineno-17-21"></a>        <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="mi">255</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">99</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">71</span> <span class="o">/</span> <span class="mi">255</span><span class="p">],</span>
</span><span id="__span-17-22"><a id="__codelineno-17-22" name="__codelineno-17-22" href="#__codelineno-17-22"></a>        <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
</span><span id="__span-17-23"><a id="__codelineno-17-23" name="__codelineno-17-23" href="#__codelineno-17-23"></a>    <span class="p">)</span>  <span class="c1"># Plot PETH</span>
</span><span id="__span-17-24"><a id="__codelineno-17-24" name="__codelineno-17-24" href="#__codelineno-17-24"></a><span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>  <span class="c1"># Plot a line at t = 0</span>
</span><span id="__span-17-25"><a id="__codelineno-17-25" name="__codelineno-17-25" href="#__codelineno-17-25"></a><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">])</span>  <span class="c1"># Set ticks on Y-axis</span>
</span><span id="__span-17-26"><a id="__codelineno-17-26" name="__codelineno-17-26" href="#__codelineno-17-26"></a><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;30&quot;</span><span class="p">])</span>  <span class="c1"># Label the ticks</span>
</span><span id="__span-17-27"><a id="__codelineno-17-27" name="__codelineno-17-27" href="#__codelineno-17-27"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time from HB (s)&quot;</span><span class="p">)</span>  <span class="c1"># Time from boundary in seconds, on X-axis</span>
</span><span id="__span-17-28"><a id="__codelineno-17-28" name="__codelineno-17-28" href="#__codelineno-17-28"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Trial Number&quot;</span><span class="p">)</span>  <span class="c1"># Trial number on Y-axis</span>
</span><span id="__span-17-29"><a id="__codelineno-17-29" name="__codelineno-17-29" href="#__codelineno-17-29"></a><span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.85</span><span class="p">)</span>
</span></code></pre></div>
<p><img alt="tutorial human dataset" class="mkd-glr-single-img" src="../images/mkd_glr_tutorial_human_dataset_001.png" srcset="../images/mkd_glr_tutorial_human_dataset_001.png" /></p>
<!-- GENERATED FROM PYTHON SOURCE LINES 184-185 -->

<p>Awesome! From the PETH, we can see that this neuron fires after boundary onset in HB trials. This is an example of what the authors describe <a href="https://www.nature.com/articles/s41593-022-01020-w">here</a> as a boundary cell.</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 187-192 -->

<hr />
<h2 id="peth-of-firing-rate-for-nb-and-hb-cells">PETH of firing rate for NB and HB cells</h2>
<p>Now that we have the PETH of spiking, we can go one step further. We will plot the mean firing rate of this cell aligned to the boundary for each trial type. Doing this in Pynapple is very simple!</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 192-197 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="n">bin_size</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># 200ms bin size</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="n">step_size</span> <span class="o">=</span> <span class="mf">0.01</span>  <span class="c1"># 10ms step size, to make overlapping bins</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="n">winsize</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">bin_size</span> <span class="o">/</span> <span class="n">step_size</span><span class="p">)</span>  <span class="c1"># Window size</span>
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 198-199 -->

<p>Use Pynapple to compute binned spike counts</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 199-203 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="n">counts_NB</span> <span class="o">=</span> <span class="n">NB_peth</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">step_size</span><span class="p">)</span>  <span class="c1"># Spike counts binned in 10ms steps, for NB trials</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="n">counts_HB</span> <span class="o">=</span> <span class="n">HB_peth</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">step_size</span><span class="p">)</span>  <span class="c1"># Spike counts binned in 10ms steps, for HB trials</span>
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 204-205 -->

<p>Smooth the binned spike counts using a window of size 20, for both trial types</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 205-217 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="n">counts_NB</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>    <span class="n">counts_NB</span><span class="o">.</span><span class="n">as_dataframe</span><span class="p">()</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>    <span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">winsize</span><span class="p">,</span> <span class="n">win_type</span><span class="o">=</span><span class="s2">&quot;gaussian&quot;</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>    <span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">std</span><span class="o">=</span><span class="mf">0.2</span> <span class="o">*</span> <span class="n">winsize</span><span class="p">)</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="p">)</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="n">counts_HB</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a>    <span class="n">counts_HB</span><span class="o">.</span><span class="n">as_dataframe</span><span class="p">()</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a>    <span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">winsize</span><span class="p">,</span> <span class="n">win_type</span><span class="o">=</span><span class="s2">&quot;gaussian&quot;</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a>    <span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">std</span><span class="o">=</span><span class="mf">0.2</span> <span class="o">*</span> <span class="n">winsize</span><span class="p">)</span>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="p">)</span>
</span></code></pre></div>
<p class="mkd-glr-script-out">Out:</p>
<div class="language-shell mkd-glr-script-out-disp highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>/home/guillaume/pynapple/docs/examples/tutorial_human_dataset.py:208:<span class="w"> </span>FutureWarning:<span class="w"> </span>The<span class="w"> </span><span class="s1">&#39;axis&#39;</span><span class="w"> </span>keyword<span class="w"> </span><span class="k">in</span><span class="w"> </span>DataFrame.rolling<span class="w"> </span>is<span class="w"> </span>deprecated<span class="w"> </span>and<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>removed<span class="w"> </span><span class="k">in</span><span class="w"> </span>a<span class="w"> </span>future<span class="w"> </span>version.<span class="w"> </span>Call<span class="w"> </span>the<span class="w"> </span>method<span class="w"> </span>without<span class="w"> </span>the<span class="w"> </span>axis<span class="w"> </span>keyword<span class="w"> </span>instead.
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="w">  </span>.rolling<span class="o">(</span>winsize,<span class="w"> </span><span class="nv">win_type</span><span class="o">=</span><span class="s2">&quot;gaussian&quot;</span>,<span class="w"> </span><span class="nv">min_periods</span><span class="o">=</span><span class="m">1</span>,<span class="w"> </span><span class="nv">center</span><span class="o">=</span>True,<span class="w"> </span><span class="nv">axis</span><span class="o">=</span><span class="m">0</span><span class="o">)</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>/home/guillaume/pynapple/docs/examples/tutorial_human_dataset.py:213:<span class="w"> </span>FutureWarning:<span class="w"> </span>The<span class="w"> </span><span class="s1">&#39;axis&#39;</span><span class="w"> </span>keyword<span class="w"> </span><span class="k">in</span><span class="w"> </span>DataFrame.rolling<span class="w"> </span>is<span class="w"> </span>deprecated<span class="w"> </span>and<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>removed<span class="w"> </span><span class="k">in</span><span class="w"> </span>a<span class="w"> </span>future<span class="w"> </span>version.<span class="w"> </span>Call<span class="w"> </span>the<span class="w"> </span>method<span class="w"> </span>without<span class="w"> </span>the<span class="w"> </span>axis<span class="w"> </span>keyword<span class="w"> </span>instead.
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="w">  </span>.rolling<span class="o">(</span>winsize,<span class="w"> </span><span class="nv">win_type</span><span class="o">=</span><span class="s2">&quot;gaussian&quot;</span>,<span class="w"> </span><span class="nv">min_periods</span><span class="o">=</span><span class="m">1</span>,<span class="w"> </span><span class="nv">center</span><span class="o">=</span>True,<span class="w"> </span><span class="nv">axis</span><span class="o">=</span><span class="m">0</span><span class="o">)</span>
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 218-219 -->

<p>Compute firing rate for both trial types</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 219-223 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="n">fr_NB</span> <span class="o">=</span> <span class="n">counts_NB</span> <span class="o">*</span> <span class="n">winsize</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="n">fr_HB</span> <span class="o">=</span> <span class="n">counts_HB</span> <span class="o">*</span> <span class="n">winsize</span>
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 224-225 -->

<p>Compute the mean firing rate for both trial types</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 225-229 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="n">meanfr_NB</span> <span class="o">=</span> <span class="n">fr_NB</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="n">meanfr_HB</span> <span class="o">=</span> <span class="n">fr_HB</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 230-231 -->

<p>Compute standard error of mean (SEM) of the firing rate for both trial types</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 231-235 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="n">error_NB</span> <span class="o">=</span> <span class="n">fr_NB</span><span class="o">.</span><span class="n">sem</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="n">error_HB</span> <span class="o">=</span> <span class="n">fr_HB</span><span class="o">.</span><span class="n">sem</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 236-237 -->

<p>Plot the mean +/- SEM of firing rate for both trial types</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 237-270 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>    <span class="n">meanfr_NB</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="mi">102</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">204</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span> <span class="o">/</span> <span class="mi">255</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;NB&quot;</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="p">)</span>  <span class="c1"># Plot mean firing rate for NB trials</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="c1"># Plot SEM for NB trials</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a>    <span class="n">meanfr_NB</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a>    <span class="n">meanfr_NB</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">error_NB</span><span class="p">,</span>
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a>    <span class="n">meanfr_NB</span><span class="o">.</span><span class="n">values</span> <span class="o">+</span> <span class="n">error_NB</span><span class="p">,</span>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a>    <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="mi">102</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">204</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span> <span class="o">/</span> <span class="mi">255</span><span class="p">],</span>
</span><span id="__span-25-12"><a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a>    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
</span><span id="__span-25-13"><a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a><span class="p">)</span>
</span><span id="__span-25-14"><a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a>
</span><span id="__span-25-15"><a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="__span-25-16"><a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a>    <span class="n">meanfr_HB</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="mi">255</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">99</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">71</span> <span class="o">/</span> <span class="mi">255</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;HB&quot;</span>
</span><span id="__span-25-17"><a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a><span class="p">)</span>  <span class="c1"># Plot mean firing rate for HB trials</span>
</span><span id="__span-25-18"><a id="__codelineno-25-18" name="__codelineno-25-18" href="#__codelineno-25-18"></a>
</span><span id="__span-25-19"><a id="__codelineno-25-19" name="__codelineno-25-19" href="#__codelineno-25-19"></a><span class="c1"># Plot SEM for NB trials</span>
</span><span id="__span-25-20"><a id="__codelineno-25-20" name="__codelineno-25-20" href="#__codelineno-25-20"></a><span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
</span><span id="__span-25-21"><a id="__codelineno-25-21" name="__codelineno-25-21" href="#__codelineno-25-21"></a>    <span class="n">meanfr_HB</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
</span><span id="__span-25-22"><a id="__codelineno-25-22" name="__codelineno-25-22" href="#__codelineno-25-22"></a>    <span class="n">meanfr_HB</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">error_HB</span><span class="p">,</span>
</span><span id="__span-25-23"><a id="__codelineno-25-23" name="__codelineno-25-23" href="#__codelineno-25-23"></a>    <span class="n">meanfr_HB</span><span class="o">.</span><span class="n">values</span> <span class="o">+</span> <span class="n">error_HB</span><span class="p">,</span>
</span><span id="__span-25-24"><a id="__codelineno-25-24" name="__codelineno-25-24" href="#__codelineno-25-24"></a>    <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="mi">255</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">99</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">71</span> <span class="o">/</span> <span class="mi">255</span><span class="p">],</span>
</span><span id="__span-25-25"><a id="__codelineno-25-25" name="__codelineno-25-25" href="#__codelineno-25-25"></a>    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
</span><span id="__span-25-26"><a id="__codelineno-25-26" name="__codelineno-25-26" href="#__codelineno-25-26"></a><span class="p">)</span>
</span><span id="__span-25-27"><a id="__codelineno-25-27" name="__codelineno-25-27" href="#__codelineno-25-27"></a>
</span><span id="__span-25-28"><a id="__codelineno-25-28" name="__codelineno-25-28" href="#__codelineno-25-28"></a><span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>  <span class="c1"># Plot a line at t = 0</span>
</span><span id="__span-25-29"><a id="__codelineno-25-29" name="__codelineno-25-29" href="#__codelineno-25-29"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time from boundary (s)&quot;</span><span class="p">)</span>  <span class="c1"># Time from boundary in seconds, on X-axis</span>
</span><span id="__span-25-30"><a id="__codelineno-25-30" name="__codelineno-25-30" href="#__codelineno-25-30"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Firing rate (Hz)&quot;</span><span class="p">)</span>  <span class="c1"># Firing rate in Hz on Y-axis</span>
</span><span id="__span-25-31"><a id="__codelineno-25-31" name="__codelineno-25-31" href="#__codelineno-25-31"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p><img alt="tutorial human dataset" class="mkd-glr-single-img" src="../images/mkd_glr_tutorial_human_dataset_002.png" srcset="../images/mkd_glr_tutorial_human_dataset_002.png" /></p>
<p class="mkd-glr-script-out">Out:</p>
<div class="language-shell mkd-glr-script-out-disp highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>&lt;matplotlib.legend.Legend<span class="w"> </span>object<span class="w"> </span>at<span class="w"> </span>0x7f2c1c47d490&gt;
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 271-274 -->

<p>This plot verifies what we visualized in the PETH rasters above, that this cell responds to a hard boundary. Hence, it is a boundary cell. To learn more about these cells, please check out the original study <a href="https://www.nature.com/articles/s41593-022-01020-w">here</a>.</p>
<p>I hope this tutorial was helpful. If you have any questions, comments or suggestions, please feel free to reach out to the Pynapple Team!</p>
<p><strong>Total running time of the script:</strong> ( 0 minutes  3.710 seconds)</p>
<div id="download_links"></div>

<p><a class="md-button center" href="../tutorial_human_dataset.py"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32v242.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64v-32c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"/></svg></span> Download Python source code: tutorial_human_dataset.py</a></p>
<p><a class="md-button center" href="../tutorial_human_dataset.ipynb"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32v242.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64v-32c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"/></svg></span> Download Jupyter notebook: tutorial_human_dataset.ipynb</a></p>
<p><a class="mkd-glr-signature" href="https://mkdocs-gallery.github.io">Gallery generated by mkdocs-gallery</a></p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.indexes"], "search": "../../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.81fa17fe.min.js"></script>
      
        <script src="../../../javascripts/katex.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>