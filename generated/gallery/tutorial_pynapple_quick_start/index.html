
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../tutorial_pynapple_core/">
      
      
        <link rel="next" href="../tutorial_pynapple_process/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.8">
    
    
      
        <title>Quick start - pynapple</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.ded33207.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
      <link rel="stylesheet" href="../../../sg_gallery-dataframe.css">
    
      <link rel="stylesheet" href="../../../sg_gallery-rendered-html.css">
    
      <link rel="stylesheet" href="../../../sg_gallery.css">
    
      <link rel="stylesheet" href="../../../sg_gallery-binder.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#quick-start" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="pynapple" class="md-header__button md-logo" aria-label="pynapple" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            pynapple
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Quick start
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/pynapple-org/pynapple" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="pynapple" class="md-nav__button md-logo" aria-label="pynapple" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    pynapple
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/pynapple-org/pynapple" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../">Usage</a>
          
            <label for="__nav_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Usage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial_pynapple_io/" class="md-nav__link">
        IO Tutorial
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial_pynapple_dandi/" class="md-nav__link">
        Streaming data from Dandi
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial_pynapple_core/" class="md-nav__link">
        Core Tutorial
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Quick start
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Quick start
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#io" class="md-nav__link">
    IO
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core" class="md-nav__link">
    Core
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tuning-curves" class="md-nav__link">
    Tuning curves
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#correlograms" class="md-nav__link">
    Correlograms
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#decoding" class="md-nav__link">
    Decoding
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#raster" class="md-nav__link">
    Raster
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial_pynapple_process/" class="md-nav__link">
        Advanced processing
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
        
          
            
          
        
          
            
          
        
          
            
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../reference/SUMMARY/">Modules</a>
          
            <label for="__nav_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Modules
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../reference/core/">Core</a>
          
            <label for="__nav_3_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Core
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/core/interval_set/" class="md-nav__link">
        Interval set
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/core/jitted_functions/" class="md-nav__link">
        Jitted functions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/core/time_series/" class="md-nav__link">
        Time series
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/core/time_units/" class="md-nav__link">
        Time units
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/core/ts_group/" class="md-nav__link">
        Ts group
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../reference/io/">Io</a>
          
            <label for="__nav_3_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Io
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/io/cnmfe/" class="md-nav__link">
        Cnmfe
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/io/ephys_gui/" class="md-nav__link">
        Ephys gui
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/io/folder/" class="md-nav__link">
        Folder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/io/interface_npz/" class="md-nav__link">
        Interface npz
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/io/interface_nwb/" class="md-nav__link">
        Interface nwb
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/io/loader/" class="md-nav__link">
        Loader
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/io/loader_gui/" class="md-nav__link">
        Loader gui
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/io/misc/" class="md-nav__link">
        Misc
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/io/neurosuite/" class="md-nav__link">
        Neurosuite
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/io/ophys_gui/" class="md-nav__link">
        Ophys gui
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/io/phy/" class="md-nav__link">
        Phy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/io/suite2p/" class="md-nav__link">
        Suite2p
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../reference/process/">Process</a>
          
            <label for="__nav_3_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          Process
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/process/correlograms/" class="md-nav__link">
        Correlograms
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/process/decoding/" class="md-nav__link">
        Decoding
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/process/perievent/" class="md-nav__link">
        Perievent
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/process/randomize/" class="md-nav__link">
        Randomize
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/process/tuning_curves/" class="md-nav__link">
        Tuning curves
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../CONTRIBUTING/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../AUTHORS/" class="md-nav__link">
        Authors
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../HISTORY/" class="md-nav__link">
        History
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#io" class="md-nav__link">
    IO
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core" class="md-nav__link">
    Core
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tuning-curves" class="md-nav__link">
    Tuning curves
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#correlograms" class="md-nav__link">
    Correlograms
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#decoding" class="md-nav__link">
    Decoding
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#raster" class="md-nav__link">
    Raster
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<!--
 DO NOT EDIT.
 THIS FILE WAS AUTOMATICALLY GENERATED BY mkdocs-gallery.
 TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
 "docs/examples/tutorial_pynapple_quick_start.py"
 LINE NUMBERS ARE GIVEN BELOW.
-->

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Click <a href="#download_links">here</a>
to download the full example code</p>
</div>
<h1 id="quick-start">Quick start</h1>
<p>The examplar data to replicate the figure in the jupyter notebook can be found <a href="https://www.dropbox.com/s/su4oaje57g3kit9/A2929-200711.zip?dl=1">here</a>. </p>
<p>The data contains a sample recordings taken simultaneously from the anterodorsal thalamus and the hippocampus and contains both a sleep and wake session. It contains both head-direction cells (i.e. cells that fire for a particular head direction in the horizontal plane) and place cells (i.e. cells that fire for a particular position in the environment).</p>
<p>Preprocessing of the data was made with <a href="https://github.com/MouseLand/Kilosort">Kilosort 2.0</a> and spike sorting was made with <a href="http://neurosuite.sourceforge.net/">Klusters</a>.</p>
<p>Instructions for installing pynapple can be found <a href="https://pynapple-org.github.io/pynapple/#installation">here</a>.</p>
<hr />
<p>This notebook is meant to provide an overview of pynapple by going through:</p>
<ul>
<li><strong>Input output (IO)</strong>. In this case, pynapple will load a NWB file using the <a href="https://pynapple-org.github.io/pynapple/io.nwb/">NWBFile object</a> within a project <a href="https://pynapple-org.github.io/pynapple/io.folder/">Folder</a> that represent a dataset. </li>
<li><strong>Core functions</strong> that handle time series, interval sets and groups of time series. See this <a href="https://pynapple-org.github.io/pynapple/notebooks/pynapple-core-notebook/">notebook</a> for a detailled usage of the core functions.</li>
<li><strong>Process functions</strong>. A small collection of high-level functions widely used in system neuroscience. This <a href="https://pynapple-org.github.io/pynapple/notebooks/pynapple-process-notebook/">notebook</a> details those functions.</li>
</ul>
<!-- GENERATED FROM PYTHON SOURCE LINES 25-29 -->

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This tutorial uses seaborn and matplotlib for displaying the figure.</p>
<p>You can install both with <code>pip install matplotlib seaborn</code></p>
</div>
<!-- GENERATED FROM PYTHON SOURCE LINES 29-39 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">import</span> <span class="nn">pynapple</span> <span class="k">as</span> <span class="nn">nap</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">custom_params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;axes.spines.right&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;axes.spines.top&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;ticks&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;colorblind&quot;</span><span class="p">,</span> <span class="n">font_scale</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">rc</span><span class="o">=</span><span class="n">custom_params</span><span class="p">)</span>
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 40-44 -->

<hr />
<h2 id="io">IO</h2>
<p>The first step is to give the path to the data folder.</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 44-47 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">DATA_DIRECTORY</span> <span class="o">=</span> <span class="s2">&quot;../../your/path/to/MyProject/&quot;</span>
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 48-50 -->

<p>We can load the session with the function <a href="https://pynapple-org.github.io/pynapple/io/#pynapple.io.misc.load_folder">load_folder</a>. Pynapple will walks throught the folder and collects every subfolders.
We can use the attribute <code>view</code> or the function <code>expand</code> to display a tree view of the dataset. The treeview shows all the compatible data format (i.e npz files or NWBs files) and their equivalent pynapple type.</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 50-53 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">data</span> <span class="o">=</span> <span class="n">nap</span><span class="o">.</span><span class="n">load_folder</span><span class="p">(</span><span class="n">DATA_DIRECTORY</span><span class="p">)</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">data</span><span class="o">.</span><span class="n">view</span>
</span></code></pre></div>
<p class="mkd-glr-script-out">Out:</p>
<div class="language-shell mkd-glr-script-out-disp highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>üìÇ<span class="w"> </span>MyProject
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>‚îî‚îÄ‚îÄ<span class="w"> </span>üìÇ<span class="w"> </span>sub-A2929
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">    </span>‚îî‚îÄ‚îÄ<span class="w"> </span>üìÇ<span class="w"> </span>ses-A2929-200711
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">        </span>‚îú‚îÄ‚îÄ<span class="w"> </span>üìÇ<span class="w"> </span>derivatives
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">        </span>‚îÇ<span class="w">   </span>‚îú‚îÄ‚îÄ<span class="w"> </span>spikes.npz<span class="w">      </span><span class="p">|</span><span class="w">        </span>TsGroup
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">        </span>‚îÇ<span class="w">   </span>‚îú‚îÄ‚îÄ<span class="w"> </span>sleep_ep.npz<span class="w">    </span><span class="p">|</span><span class="w">        </span>IntervalSet
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">        </span>‚îÇ<span class="w">   </span>‚îú‚îÄ‚îÄ<span class="w"> </span>position.npz<span class="w">    </span><span class="p">|</span><span class="w">        </span>TsdFrame
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">        </span>‚îÇ<span class="w">   </span>‚îî‚îÄ‚îÄ<span class="w"> </span>wake_ep.npz<span class="w">     </span><span class="p">|</span><span class="w">        </span>IntervalSet
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="w">        </span>‚îú‚îÄ‚îÄ<span class="w"> </span>üìÇ<span class="w"> </span>pynapplenwb
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="w">        </span>‚îÇ<span class="w">   </span>‚îî‚îÄ‚îÄ<span class="w"> </span>A2929-200711<span class="w">    </span><span class="p">|</span><span class="w">        </span>NWB<span class="w"> </span>file
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="w">        </span>‚îú‚îÄ‚îÄ<span class="w"> </span>x_plus_y.npz<span class="w">    </span><span class="p">|</span><span class="w">        </span>Tsd
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="w">        </span>‚îî‚îÄ‚îÄ<span class="w"> </span>stimulus-fish.npz<span class="w">       </span><span class="p">|</span><span class="w">        </span>IntervalSet
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 54-57 -->

<p>The object <code>data</code> is a <a href="https://pynapple-org.github.io/pynapple/io.folder/"><code>Folder</code></a> object that allows easy navigation and interaction with a dataset.
In this case, we want to load the NWB file in the folder <code>/pynapplenwb</code>. Data are always lazy loaded. No time series is loaded until it's actually called.
When calling the NWB file, the object <code>nwb</code> is an interface to the NWB file. All the data inside the NWB file that are compatible with one of the pynapple objects are shown with their corresponding keys.</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 57-61 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">nwb</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;sub-A2929&quot;</span><span class="p">][</span><span class="s2">&quot;ses-A2929-200711&quot;</span><span class="p">][</span><span class="s2">&quot;pynapplenwb&quot;</span><span class="p">][</span><span class="s2">&quot;A2929-200711&quot;</span><span class="p">]</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">nwb</span><span class="p">)</span>
</span></code></pre></div>
<p class="mkd-glr-script-out">Out:</p>
<div class="language-shell mkd-glr-script-out-disp highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="w">             </span>A2929-200711<span class="w">              </span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>‚îè‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚î≥‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îì
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>‚îÉ<span class="w"> </span>Keys<span class="w">                  </span>‚îÉ<span class="w"> </span>Type<span class="w">        </span>‚îÉ
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>‚î°‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚ïá‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚î©
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>‚îÇ<span class="w"> </span>units<span class="w">                 </span>‚îÇ<span class="w"> </span>TsGroup<span class="w">     </span>‚îÇ
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>‚îÇ<span class="w"> </span>position_time_support<span class="w"> </span>‚îÇ<span class="w"> </span>IntervalSet<span class="w"> </span>‚îÇ
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>‚îÇ<span class="w"> </span>epochs<span class="w">                </span>‚îÇ<span class="w"> </span>IntervalSet<span class="w"> </span>‚îÇ
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>‚îÇ<span class="w"> </span>z<span class="w">                     </span>‚îÇ<span class="w"> </span>Tsd<span class="w">         </span>‚îÇ
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>‚îÇ<span class="w"> </span>y<span class="w">                     </span>‚îÇ<span class="w"> </span>Tsd<span class="w">         </span>‚îÇ
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>‚îÇ<span class="w"> </span>x<span class="w">                     </span>‚îÇ<span class="w"> </span>Tsd<span class="w">         </span>‚îÇ
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>‚îÇ<span class="w"> </span>rz<span class="w">                    </span>‚îÇ<span class="w"> </span>Tsd<span class="w">         </span>‚îÇ
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>‚îÇ<span class="w"> </span>ry<span class="w">                    </span>‚îÇ<span class="w"> </span>Tsd<span class="w">         </span>‚îÇ
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>‚îÇ<span class="w"> </span>rx<span class="w">                    </span>‚îÇ<span class="w"> </span>Tsd<span class="w">         </span>‚îÇ
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 62-66 -->

<p>We can individually call each object and they are actually loaded.</p>
<p><code>units</code> is a <a href="https://pynapple-org.github.io/pynapple/core.ts_group/">TsGroup</a> object. It allows to group together time series with different timestamps and couple metainformation to each neuron. In this case, the location of where the neuron was recorded has been added when loading the session for the first time.
We load <code>units</code> as <code>spikes</code></p>
<!-- GENERATED FROM PYTHON SOURCE LINES 66-69 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">spikes</span> <span class="o">=</span> <span class="n">nwb</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">spikes</span><span class="p">)</span>
</span></code></pre></div>
<p class="mkd-glr-script-out">Out:</p>
<div class="language-shell mkd-glr-script-out-disp highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="w">  </span>Index<span class="w">    </span>rate<span class="w">  </span>location<span class="w">      </span>group
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>-------<span class="w">  </span>------<span class="w">  </span>----------<span class="w">  </span>-------
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">      </span><span class="m">0</span><span class="w">    </span><span class="m">7</span>.3<span class="w">   </span>adn<span class="w">               </span><span class="m">0</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">      </span><span class="m">1</span><span class="w">    </span><span class="m">5</span>.73<span class="w">  </span>adn<span class="w">               </span><span class="m">0</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">      </span><span class="m">2</span><span class="w">    </span><span class="m">8</span>.12<span class="w">  </span>adn<span class="w">               </span><span class="m">0</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="w">      </span><span class="m">3</span><span class="w">    </span><span class="m">6</span>.68<span class="w">  </span>adn<span class="w">               </span><span class="m">0</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="w">      </span><span class="m">4</span><span class="w">   </span><span class="m">10</span>.77<span class="w">  </span>adn<span class="w">               </span><span class="m">0</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="w">      </span><span class="m">5</span><span class="w">   </span><span class="m">11</span><span class="w">     </span>adn<span class="w">               </span><span class="m">0</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="w">      </span><span class="m">6</span><span class="w">   </span><span class="m">16</span>.52<span class="w">  </span>adn<span class="w">               </span><span class="m">0</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="w">      </span><span class="m">7</span><span class="w">    </span><span class="m">2</span>.2<span class="w">   </span>ca1<span class="w">               </span><span class="m">1</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="w">      </span><span class="m">8</span><span class="w">    </span><span class="m">2</span>.02<span class="w">  </span>ca1<span class="w">               </span><span class="m">1</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="w">      </span><span class="m">9</span><span class="w">    </span><span class="m">1</span>.07<span class="w">  </span>ca1<span class="w">               </span><span class="m">1</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="w">     </span><span class="m">10</span><span class="w">    </span><span class="m">3</span>.92<span class="w">  </span>ca1<span class="w">               </span><span class="m">1</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="w">     </span><span class="m">11</span><span class="w">    </span><span class="m">3</span>.31<span class="w">  </span>ca1<span class="w">               </span><span class="m">1</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="w">     </span><span class="m">12</span><span class="w">    </span><span class="m">1</span>.09<span class="w">  </span>ca1<span class="w">               </span><span class="m">1</span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="w">     </span><span class="m">13</span><span class="w">    </span><span class="m">1</span>.28<span class="w">  </span>ca1<span class="w">               </span><span class="m">1</span>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a><span class="w">     </span><span class="m">14</span><span class="w">    </span><span class="m">1</span>.32<span class="w">  </span>ca1<span class="w">               </span><span class="m">1</span>
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 70-71 -->

<p>In this case, the TsGroup holds 15 neurons and it is possible to access, similar to a dictionnary, the spike times of a single neuron:</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 71-74 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">neuron_0</span> <span class="o">=</span> <span class="n">spikes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">neuron_0</span><span class="p">)</span>
</span></code></pre></div>
<p class="mkd-glr-script-out">Out:</p>
<div class="language-shell mkd-glr-script-out-disp highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>Time<span class="w"> </span><span class="o">(</span>s<span class="o">)</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="m">0</span>.00845<span class="w">      </span>NaN
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="m">0</span>.03265<span class="w">      </span>NaN
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="m">0</span>.13230<span class="w">      </span>NaN
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="m">0</span>.30340<span class="w">      </span>NaN
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="m">0</span>.32900<span class="w">      </span>NaN
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="w">              </span>..
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="m">1186</span>.12755<span class="w">   </span>NaN
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="m">1189</span>.38400<span class="w">   </span>NaN
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="m">1194</span>.13475<span class="w">   </span>NaN
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="m">1196</span>.20750<span class="w">   </span>NaN
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="m">1196</span>.67675<span class="w">   </span>NaN
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>Length:<span class="w"> </span><span class="m">8764</span>,<span class="w"> </span>dtype:<span class="w"> </span>float64
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 75-76 -->

<p><em>neuron_0</em> is a <a href="https://pynapple-org.github.io/pynapple/core.time_series/#pynapple.core.time_series.Ts">Ts</a> object containing the times of the spikes.</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 78-79 -->

<p>The other information about the session is contained in <code>nwb["epochs"]</code>. In this case, the start and end of the sleep and wake epochs. If the NWB time intervals contains tags of the epochs, pynapple will try to group them together and return a dictionnary of IntervalSet instead of IntervalSet.</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 79-83 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">epochs</span> <span class="o">=</span> <span class="n">nwb</span><span class="p">[</span><span class="s2">&quot;epochs&quot;</span><span class="p">]</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">epochs</span><span class="p">)</span>
</span></code></pre></div>
<p class="mkd-glr-script-out">Out:</p>
<div class="language-shell mkd-glr-script-out-disp highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="o">{</span><span class="s1">&#39;sleep&#39;</span>:<span class="w">    </span>start<span class="w">    </span>end
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="m">0</span><span class="w">    </span><span class="m">0</span>.0<span class="w">  </span><span class="m">600</span>.0,<span class="w"> </span><span class="s1">&#39;wake&#39;</span>:<span class="w">    </span>start<span class="w">     </span>end
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="m">0</span><span class="w">  </span><span class="m">600</span>.0<span class="w">  </span><span class="m">1200</span>.0<span class="o">}</span>
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 84-86 -->

<p>Finally this dataset contains tracking of the animal in the environment. <code>rx</code>, <code>ry</code>, <code>rz</code> represent respectively the roll, the yaw and the pitch of the head of the animal. <code>x</code> and <code>z</code> represent the position of the animal in the horizontal plane while <code>y</code> represents the elevation.
Here we load only the head-direction as a Tsd object.</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 86-90 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="n">head_direction</span> <span class="o">=</span> <span class="n">nwb</span><span class="p">[</span><span class="s2">&quot;ry&quot;</span><span class="p">]</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">head_direction</span><span class="p">)</span>
</span></code></pre></div>
<p class="mkd-glr-script-out">Out:</p>
<div class="language-shell mkd-glr-script-out-disp highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>Time<span class="w"> </span><span class="o">(</span>s<span class="o">)</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="m">670</span>.64070<span class="w">     </span><span class="m">5</span>.207148
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="m">670</span>.64900<span class="w">     </span><span class="m">5</span>.181029
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="m">670</span>.65735<span class="w">     </span><span class="m">5</span>.155508
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="m">670</span>.66565<span class="w">     </span><span class="m">5</span>.136537
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="m">670</span>.67400<span class="w">     </span><span class="m">5</span>.120850
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="w">                </span>...<span class="w">   </span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="m">1199</span>.96160<span class="w">    </span><span class="m">3</span>.665954
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="m">1199</span>.96995<span class="w">    </span><span class="m">3</span>.634619
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="m">1199</span>.97825<span class="w">    </span><span class="m">3</span>.617849
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="m">1199</span>.98660<span class="w">    </span><span class="m">3</span>.609446
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="m">1199</span>.99495<span class="w">    </span><span class="m">3</span>.609375
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a>Length:<span class="w"> </span><span class="m">63527</span>,<span class="w"> </span>dtype:<span class="w"> </span>float64
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 91-95 -->

<hr />
<h2 id="core">Core</h2>
<p>The core functions of pynapple provides many ways to manipulate time series. In this example, spike times are restricted to the wake epoch. Notice how the frequencies change from the original object.</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 95-102 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="n">wake_ep</span> <span class="o">=</span> <span class="n">epochs</span><span class="p">[</span><span class="s2">&quot;wake&quot;</span><span class="p">]</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="n">spikes_wake</span> <span class="o">=</span> <span class="n">spikes</span><span class="o">.</span><span class="n">restrict</span><span class="p">(</span><span class="n">wake_ep</span><span class="p">)</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="nb">print</span><span class="p">(</span><span class="n">spikes_wake</span><span class="p">)</span>
</span></code></pre></div>
<p class="mkd-glr-script-out">Out:</p>
<div class="language-shell mkd-glr-script-out-disp highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="w">  </span>Index<span class="w">    </span>rate<span class="w">  </span>location<span class="w">      </span>group
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>-------<span class="w">  </span>------<span class="w">  </span>----------<span class="w">  </span>-------
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="w">      </span><span class="m">0</span><span class="w">    </span><span class="m">4</span>.85<span class="w">  </span>adn<span class="w">               </span><span class="m">0</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="w">      </span><span class="m">1</span><span class="w">    </span><span class="m">8</span>.06<span class="w">  </span>adn<span class="w">               </span><span class="m">0</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="w">      </span><span class="m">2</span><span class="w">    </span><span class="m">7</span>.11<span class="w">  </span>adn<span class="w">               </span><span class="m">0</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="w">      </span><span class="m">3</span><span class="w">    </span><span class="m">7</span>.66<span class="w">  </span>adn<span class="w">               </span><span class="m">0</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="w">      </span><span class="m">4</span><span class="w">    </span><span class="m">7</span>.97<span class="w">  </span>adn<span class="w">               </span><span class="m">0</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="w">      </span><span class="m">5</span><span class="w">   </span><span class="m">11</span>.29<span class="w">  </span>adn<span class="w">               </span><span class="m">0</span>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="w">      </span><span class="m">6</span><span class="w">   </span><span class="m">22</span>.08<span class="w">  </span>adn<span class="w">               </span><span class="m">0</span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="w">      </span><span class="m">7</span><span class="w">    </span><span class="m">1</span>.82<span class="w">  </span>ca1<span class="w">               </span><span class="m">1</span>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="w">      </span><span class="m">8</span><span class="w">    </span><span class="m">2</span>.84<span class="w">  </span>ca1<span class="w">               </span><span class="m">1</span>
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="w">      </span><span class="m">9</span><span class="w">    </span><span class="m">0</span>.7<span class="w">   </span>ca1<span class="w">               </span><span class="m">1</span>
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="w">     </span><span class="m">10</span><span class="w">    </span><span class="m">4</span>.78<span class="w">  </span>ca1<span class="w">               </span><span class="m">1</span>
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a><span class="w">     </span><span class="m">11</span><span class="w">    </span><span class="m">4</span>.93<span class="w">  </span>ca1<span class="w">               </span><span class="m">1</span>
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a><span class="w">     </span><span class="m">12</span><span class="w">    </span><span class="m">1</span>.71<span class="w">  </span>ca1<span class="w">               </span><span class="m">1</span>
</span><span id="__span-15-16"><a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a><span class="w">     </span><span class="m">13</span><span class="w">    </span><span class="m">0</span>.97<span class="w">  </span>ca1<span class="w">               </span><span class="m">1</span>
</span><span id="__span-15-17"><a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a><span class="w">     </span><span class="m">14</span><span class="w">    </span><span class="m">0</span>.26<span class="w">  </span>ca1<span class="w">               </span><span class="m">1</span>
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 103-104 -->

<p>The same operation can be applied to all time series.</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 104-122 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c1"># In this example, we want all the epochs for which position in `x` is above a certain threhsold. For this we use the function `threshold`.</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="n">posx</span> <span class="o">=</span> <span class="n">nwb</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.08</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="n">posxpositive</span> <span class="o">=</span> <span class="n">posx</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">threshold</span><span class="p">)</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">posx</span><span class="p">)</span>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">posxpositive</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">threshold</span><span class="p">)</span>
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">)</span>
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;x &gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">threshold</span><span class="p">))</span>
</span><span id="__span-16-15"><a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="__span-16-16"><a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<p><img alt="x &gt; 0.08" class="mkd-glr-single-img" src="../images/mkd_glr_tutorial_pynapple_quick_start_001.png" srcset="../images/mkd_glr_tutorial_pynapple_quick_start_001.png" /></p>
<!-- GENERATED FROM PYTHON SOURCE LINES 123-124 -->

<p>The epochs above the threshold can be accessed through the <strong>time support</strong> of the Tsd object. The time support is an important concept in the pynapple package. It helps the user to define the epochs for which the time serie should be defined. By default, Ts, Tsd and TsGroup objects possess a time support (defined as an IntervalSet). It is recommended to pass the time support when instantiating one of those objects.</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 124-128 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="n">epochs_above_thr</span> <span class="o">=</span> <span class="n">posxpositive</span><span class="o">.</span><span class="n">time_support</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">epochs_above_thr</span><span class="p">)</span>
</span></code></pre></div>
<p class="mkd-glr-script-out">Out:</p>
<div class="language-shell mkd-glr-script-out-disp highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="w">        </span>start<span class="w">         </span>end
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="m">0</span><span class="w">  </span><span class="m">682</span>.660850<span class="w">  </span><span class="m">745</span>.565725
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="m">1</span><span class="w">  </span><span class="m">752</span>.240350<span class="w">  </span><span class="m">752</span>.440325
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="m">2</span><span class="w">  </span><span class="m">752</span>.582000<span class="w">  </span><span class="m">752</span>.673650
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="m">3</span><span class="w">  </span><span class="m">757</span>.498375<span class="w">  </span><span class="m">758</span>.998300
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="m">4</span><span class="w">  </span><span class="m">789</span>.863275<span class="w">  </span><span class="m">790</span>.271575
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="m">5</span><span class="w">  </span><span class="m">875</span>.225250<span class="w">  </span><span class="m">876</span>.066875
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="m">6</span><span class="w">  </span><span class="m">878</span>.158425<span class="w">  </span><span class="m">878</span>.641725
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 129-133 -->

<hr />
<h2 id="tuning-curves">Tuning curves</h2>
<p>Let's do a more advanced analysis. Neurons from ADn (group 0 in the <code>spikes</code> group object) are know to fire for a particular direction. Therefore, we can compute their tuning curves, i.e. their firing rates as a function of the head-direction of the animal in the horizontal plane (<em>ry</em>). To do this, we can use the function <a href="https://pynapple-org.github.io/pynapple/process.tuning_curves/#pynapple.process.tuning_curves.compute_1d_tuning_curves"><code>compute_1d_tuning_curves</code></a>. In this case, the tuning curves are computed over 120 bins and between 0 and 2$\pi$.</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 133-140 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="n">tuning_curves</span> <span class="o">=</span> <span class="n">nap</span><span class="o">.</span><span class="n">compute_1d_tuning_curves</span><span class="p">(</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>    <span class="n">group</span><span class="o">=</span><span class="n">spikes</span><span class="p">,</span> <span class="n">feature</span><span class="o">=</span><span class="n">head_direction</span><span class="p">,</span> <span class="n">nb_bins</span><span class="o">=</span><span class="mi">121</span><span class="p">,</span> <span class="n">minmax</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="p">)</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="nb">print</span><span class="p">(</span><span class="n">tuning_curves</span><span class="p">)</span>
</span></code></pre></div>
<p class="mkd-glr-script-out">Out:</p>
<div class="language-shell mkd-glr-script-out-disp highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="w">                 </span><span class="m">0</span><span class="w">    </span><span class="m">1</span><span class="w">         </span><span class="m">2</span><span class="w">          </span><span class="m">3</span><span class="w">         </span><span class="m">4</span><span class="w">   </span>...<span class="w">         </span><span class="m">10</span><span class="w">         </span><span class="m">11</span><span class="w">         </span><span class="m">12</span><span class="w">        </span><span class="m">13</span><span class="w">        </span><span class="m">14</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="m">0</span>.025964<span class="w">  </span><span class="m">45</span>.520459<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.000000<span class="w">   </span><span class="m">6</span>.207335<span class="w">  </span><span class="m">6</span>.207335<span class="w">  </span>...<span class="w">   </span><span class="m">6</span>.207335<span class="w">  </span><span class="m">10</span>.345559<span class="w">  </span><span class="m">14</span>.483782<span class="w">  </span><span class="m">0</span>.000000<span class="w">  </span><span class="m">2</span>.069112
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="m">0</span>.077891<span class="w">  </span><span class="m">55</span>.049762<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.000000<span class="w">   </span><span class="m">5</span>.504976<span class="w">  </span><span class="m">3</span>.302986<span class="w">  </span>...<span class="w">   </span><span class="m">8</span>.807962<span class="w">  </span><span class="m">16</span>.514929<span class="w">   </span><span class="m">1</span>.100995<span class="w">  </span><span class="m">0</span>.000000<span class="w">  </span><span class="m">0</span>.000000
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="m">0</span>.129818<span class="w">  </span><span class="m">76</span>.369034<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.000000<span class="w">  </span><span class="m">17</span>.144069<span class="w">  </span><span class="m">4</span>.675655<span class="w">  </span>...<span class="w">   </span><span class="m">3</span>.117103<span class="w">  </span><span class="m">12</span>.468414<span class="w">   </span><span class="m">9</span>.351310<span class="w">  </span><span class="m">1</span>.558552<span class="w">  </span><span class="m">0</span>.000000
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="m">0</span>.181745<span class="w">  </span><span class="m">82</span>.179721<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.000000<span class="w">   </span><span class="m">6</span>.522200<span class="w">  </span><span class="m">1</span>.304440<span class="w">  </span>...<span class="w">   </span><span class="m">6</span>.522200<span class="w">  </span><span class="m">19</span>.566600<span class="w">   </span><span class="m">9</span>.131080<span class="w">  </span><span class="m">2</span>.608880<span class="w">  </span><span class="m">0</span>.000000
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="m">0</span>.233672<span class="w">  </span><span class="m">73</span>.851374<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.000000<span class="w">  </span><span class="m">13</span>.187745<span class="w">  </span><span class="m">5</span>.275098<span class="w">  </span>...<span class="w">  </span><span class="m">15</span>.825294<span class="w">  </span><span class="m">30</span>.331814<span class="w">   </span><span class="m">7</span>.912647<span class="w">  </span><span class="m">2</span>.637549<span class="w">  </span><span class="m">0</span>.000000
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a>...<span class="w">             </span>...<span class="w">  </span>...<span class="w">       </span>...<span class="w">        </span>...<span class="w">       </span>...<span class="w">  </span>...<span class="w">        </span>...<span class="w">        </span>...<span class="w">        </span>...<span class="w">       </span>...<span class="w">       </span>...
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="m">6</span>.049513<span class="w">  </span><span class="m">15</span>.001060<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.000000<span class="w">  </span><span class="m">12</span>.273595<span class="w">  </span><span class="m">1</span>.363733<span class="w">  </span>...<span class="w">   </span><span class="m">8</span>.182397<span class="w">   </span><span class="m">2</span>.727466<span class="w">   </span><span class="m">0</span>.000000<span class="w">  </span><span class="m">0</span>.000000<span class="w">  </span><span class="m">1</span>.363733
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="m">6</span>.101440<span class="w">  </span><span class="m">22</span>.327159<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.000000<span class="w">  </span><span class="m">13</span>.954475<span class="w">  </span><span class="m">0</span>.000000<span class="w">  </span>...<span class="w">   </span><span class="m">2</span>.790895<span class="w">  </span><span class="m">11</span>.163580<span class="w">   </span><span class="m">2</span>.790895<span class="w">  </span><span class="m">0</span>.000000<span class="w">  </span><span class="m">0</span>.000000
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="m">6</span>.153367<span class="w">  </span><span class="m">47</span>.062150<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.000000<span class="w">  </span><span class="m">21</span>.177967<span class="w">  </span><span class="m">0</span>.000000<span class="w">  </span>...<span class="w">   </span><span class="m">7</span>.059322<span class="w">  </span><span class="m">11</span>.765537<span class="w">   </span><span class="m">0</span>.000000<span class="w">  </span><span class="m">2</span>.353107<span class="w">  </span><span class="m">0</span>.000000
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="m">6</span>.205295<span class="w">  </span><span class="m">56</span>.003958<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">2</span>.000141<span class="w">   </span><span class="m">8</span>.000565<span class="w">  </span><span class="m">2</span>.000141<span class="w">  </span>...<span class="w">  </span><span class="m">14</span>.000990<span class="w">  </span><span class="m">24</span>.001696<span class="w">   </span><span class="m">6</span>.000424<span class="w">  </span><span class="m">0</span>.000000<span class="w">  </span><span class="m">0</span>.000000
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a><span class="m">6</span>.257222<span class="w">  </span><span class="m">38</span>.712414<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.000000<span class="w">   </span><span class="m">7</span>.742483<span class="w">  </span><span class="m">0</span>.000000<span class="w">  </span>...<span class="w">   </span><span class="m">7</span>.742483<span class="w">   </span><span class="m">7</span>.742483<span class="w">   </span><span class="m">7</span>.742483<span class="w">  </span><span class="m">0</span>.000000<span class="w">  </span><span class="m">0</span>.000000
</span><span id="__span-20-13"><a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a>
</span><span id="__span-20-14"><a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a><span class="o">[</span><span class="m">121</span><span class="w"> </span>rows<span class="w"> </span>x<span class="w"> </span><span class="m">15</span><span class="w"> </span>columns<span class="o">]</span>
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 141-142 -->

<p>We can plot tuning curves in polar plots.</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 142-154 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="n">neuron_location</span> <span class="o">=</span> <span class="n">spikes</span><span class="o">.</span><span class="n">get_info</span><span class="p">(</span><span class="s2">&quot;location&quot;</span><span class="p">)</span>  <span class="c1"># to know where the neuron was recorded</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tuning_curves</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;polar&quot;</span><span class="p">)</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tuning_curves</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">neuron_location</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<p><img alt="adn-0, adn-1, adn-2, adn-3, adn-4, adn-5, adn-6, ca1-7, ca1-8, ca1-9, ca1-10, ca1-11, ca1-12, ca1-13, ca1-14" class="mkd-glr-single-img" src="../images/mkd_glr_tutorial_pynapple_quick_start_002.png" srcset="../images/mkd_glr_tutorial_pynapple_quick_start_002.png" /></p>
<!-- GENERATED FROM PYTHON SOURCE LINES 155-156 -->

<p>While ADN neurons show obvious modulation for head-direction, it is not obvious for all CA1 cells. Therefore we want to restrict the remaining of the analyses to only ADN neurons. We can split the <code>spikes</code> group with the function <a href="https://pynapple-org.github.io/pynapple/core.ts_group/#pynapple.core.ts_group.TsGroup.getby_category"><code>getby_category</code></a>.</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 156-165 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="n">spikes_by_location</span> <span class="o">=</span> <span class="n">spikes</span><span class="o">.</span><span class="n">getby_category</span><span class="p">(</span><span class="s2">&quot;location&quot;</span><span class="p">)</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">spikes_by_location</span><span class="p">[</span><span class="s2">&quot;adn&quot;</span><span class="p">])</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="nb">print</span><span class="p">(</span><span class="n">spikes_by_location</span><span class="p">[</span><span class="s2">&quot;ca1&quot;</span><span class="p">])</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="n">spikes_adn</span> <span class="o">=</span> <span class="n">spikes_by_location</span><span class="p">[</span><span class="s2">&quot;adn&quot;</span><span class="p">]</span>
</span></code></pre></div>
<p class="mkd-glr-script-out">Out:</p>
<div class="language-shell mkd-glr-script-out-disp highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="w">  </span>Index<span class="w">    </span>rate<span class="w">  </span>location<span class="w">      </span>group
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>-------<span class="w">  </span>------<span class="w">  </span>----------<span class="w">  </span>-------
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="w">      </span><span class="m">0</span><span class="w">    </span><span class="m">7</span>.3<span class="w">   </span>adn<span class="w">               </span><span class="m">0</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="w">      </span><span class="m">1</span><span class="w">    </span><span class="m">5</span>.73<span class="w">  </span>adn<span class="w">               </span><span class="m">0</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="w">      </span><span class="m">2</span><span class="w">    </span><span class="m">8</span>.12<span class="w">  </span>adn<span class="w">               </span><span class="m">0</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="w">      </span><span class="m">3</span><span class="w">    </span><span class="m">6</span>.68<span class="w">  </span>adn<span class="w">               </span><span class="m">0</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="w">      </span><span class="m">4</span><span class="w">   </span><span class="m">10</span>.77<span class="w">  </span>adn<span class="w">               </span><span class="m">0</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="w">      </span><span class="m">5</span><span class="w">   </span><span class="m">11</span><span class="w">     </span>adn<span class="w">               </span><span class="m">0</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="w">      </span><span class="m">6</span><span class="w">   </span><span class="m">16</span>.52<span class="w">  </span>adn<span class="w">               </span><span class="m">0</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="w">  </span>Index<span class="w">    </span>rate<span class="w">  </span>location<span class="w">      </span>group
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a>-------<span class="w">  </span>------<span class="w">  </span>----------<span class="w">  </span>-------
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a><span class="w">      </span><span class="m">7</span><span class="w">    </span><span class="m">2</span>.2<span class="w">   </span>ca1<span class="w">               </span><span class="m">1</span>
</span><span id="__span-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a><span class="w">      </span><span class="m">8</span><span class="w">    </span><span class="m">2</span>.02<span class="w">  </span>ca1<span class="w">               </span><span class="m">1</span>
</span><span id="__span-23-14"><a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a><span class="w">      </span><span class="m">9</span><span class="w">    </span><span class="m">1</span>.07<span class="w">  </span>ca1<span class="w">               </span><span class="m">1</span>
</span><span id="__span-23-15"><a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a><span class="w">     </span><span class="m">10</span><span class="w">    </span><span class="m">3</span>.92<span class="w">  </span>ca1<span class="w">               </span><span class="m">1</span>
</span><span id="__span-23-16"><a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a><span class="w">     </span><span class="m">11</span><span class="w">    </span><span class="m">3</span>.31<span class="w">  </span>ca1<span class="w">               </span><span class="m">1</span>
</span><span id="__span-23-17"><a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a><span class="w">     </span><span class="m">12</span><span class="w">    </span><span class="m">1</span>.09<span class="w">  </span>ca1<span class="w">               </span><span class="m">1</span>
</span><span id="__span-23-18"><a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a><span class="w">     </span><span class="m">13</span><span class="w">    </span><span class="m">1</span>.28<span class="w">  </span>ca1<span class="w">               </span><span class="m">1</span>
</span><span id="__span-23-19"><a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a><span class="w">     </span><span class="m">14</span><span class="w">    </span><span class="m">1</span>.32<span class="w">  </span>ca1<span class="w">               </span><span class="m">1</span>
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 166-172 -->

<hr />
<h2 id="correlograms">Correlograms</h2>
<p>A classical question with head-direction cells is how pairs stay coordinated across brain states i.e. wake vs sleep (see Peyrache, A., Lacroix, M. M., Petersen, P. C., &amp; Buzs√°ki, G. (2015). Internally organized mechanisms of the head direction sense. Nature neuroscience, 18(4), 569-575.)</p>
<p>In this example, this coordination across brain states will be evaluated with cross-correlograms of pairs of neurons. We can call the function <a href="https://pynapple-org.github.io/pynapple/process.correlograms/#pynapple.process.correlograms.compute_crosscorrelogram"><code>compute_crosscorrelogram</code></a> during both sleep and wake epochs.</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 172-191 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="n">cc_wake</span> <span class="o">=</span> <span class="n">nap</span><span class="o">.</span><span class="n">compute_crosscorrelogram</span><span class="p">(</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>    <span class="n">group</span><span class="o">=</span><span class="n">spikes_adn</span><span class="p">,</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>    <span class="n">binsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>  <span class="c1"># ms</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>    <span class="n">windowsize</span><span class="o">=</span><span class="mi">4000</span><span class="p">,</span>  <span class="c1"># ms</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>    <span class="n">ep</span><span class="o">=</span><span class="n">epochs</span><span class="p">[</span><span class="s2">&quot;wake&quot;</span><span class="p">],</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>    <span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>    <span class="n">time_units</span><span class="o">=</span><span class="s2">&quot;ms&quot;</span><span class="p">,</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="p">)</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a><span class="n">cc_sleep</span> <span class="o">=</span> <span class="n">nap</span><span class="o">.</span><span class="n">compute_crosscorrelogram</span><span class="p">(</span>
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a>    <span class="n">group</span><span class="o">=</span><span class="n">spikes_adn</span><span class="p">,</span>
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a>    <span class="n">binsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>  <span class="c1"># ms</span>
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a>    <span class="n">windowsize</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>  <span class="c1"># ms</span>
</span><span id="__span-24-14"><a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a>    <span class="n">ep</span><span class="o">=</span><span class="n">epochs</span><span class="p">[</span><span class="s2">&quot;sleep&quot;</span><span class="p">],</span>
</span><span id="__span-24-15"><a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a>    <span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-24-16"><a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a>    <span class="n">time_units</span><span class="o">=</span><span class="s2">&quot;ms&quot;</span><span class="p">,</span>
</span><span id="__span-24-17"><a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a><span class="p">)</span>
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 192-194 -->

<p>From the previous figure, we can see that neurons 0 and 1 fires for opposite directions during wake. Therefore we expect their cross-correlograms to show a trough around 0 time lag, meaning those two neurons do not fire spikes together. A similar trough during sleep for the same pair thus indicates a persistence of their coordination even if the animal is not moving its head.
mkdocs_gallery_thumbnail_number = 3</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 194-218 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="n">xtwake</span> <span class="o">=</span> <span class="n">cc_wake</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="n">xtsleep</span> <span class="o">=</span> <span class="n">cc_sleep</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;polar&quot;</span><span class="p">)</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tuning_curves</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>  <span class="c1"># The tuning curves of the pair [0,1]</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a>    <span class="n">xtwake</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">xtwake</span><span class="p">),</span> <span class="n">cc_wake</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkgray&quot;</span>
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a><span class="p">)</span>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;wake&quot;</span><span class="p">)</span>
</span><span id="__span-25-12"><a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time (ms)&quot;</span><span class="p">)</span>
</span><span id="__span-25-13"><a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;CC&quot;</span><span class="p">)</span>
</span><span id="__span-25-14"><a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span>
</span><span id="__span-25-15"><a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a><span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
</span><span id="__span-25-16"><a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a>    <span class="n">xtsleep</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">xtsleep</span><span class="p">),</span> <span class="n">cc_sleep</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span>
</span><span id="__span-25-17"><a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a><span class="p">)</span>
</span><span id="__span-25-18"><a id="__codelineno-25-18" name="__codelineno-25-18" href="#__codelineno-25-18"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;sleep&quot;</span><span class="p">)</span>
</span><span id="__span-25-19"><a id="__codelineno-25-19" name="__codelineno-25-19" href="#__codelineno-25-19"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time (ms)&quot;</span><span class="p">)</span>
</span><span id="__span-25-20"><a id="__codelineno-25-20" name="__codelineno-25-20" href="#__codelineno-25-20"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;CC&quot;</span><span class="p">)</span>
</span><span id="__span-25-21"><a id="__codelineno-25-21" name="__codelineno-25-21" href="#__codelineno-25-21"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="__span-25-22"><a id="__codelineno-25-22" name="__codelineno-25-22" href="#__codelineno-25-22"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<p><img alt="wake, sleep" class="mkd-glr-single-img" src="../images/mkd_glr_tutorial_pynapple_quick_start_003.png" srcset="../images/mkd_glr_tutorial_pynapple_quick_start_003.png" /></p>
<!-- GENERATED FROM PYTHON SOURCE LINES 219-228 -->

<hr />
<h2 id="decoding">Decoding</h2>
<p>This last analysis shows how to use the pynapple's decoding function.</p>
<p>The previous result indicates a persistent coordination of head-direction cells during sleep. Therefore it is possible to decode a virtual head-direction signal even if the animal is not moving its head.
This example uses the function <a href="https://pynapple-org.github.io/pynapple/process.decoding/#pynapple.process.decoding.decode_1d"><code>decode_1d</code></a> which implements bayesian decoding (see : Zhang, K., Ginzburg, I., McNaughton, B. L., &amp; Sejnowski, T. J. (1998). Interpreting neuronal population activity by reconstruction: unified framework with application to hippocampal place cells. Journal of neurophysiology, 79(2), 1017-1044.)</p>
<p>First we can validate the decoding function with the real position of the head of the animal during wake.</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 228-242 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="n">tuning_curves_adn</span> <span class="o">=</span> <span class="n">nap</span><span class="o">.</span><span class="n">compute_1d_tuning_curves</span><span class="p">(</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>    <span class="n">spikes_adn</span><span class="p">,</span> <span class="n">head_direction</span><span class="p">,</span> <span class="n">nb_bins</span><span class="o">=</span><span class="mi">61</span><span class="p">,</span> <span class="n">minmax</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="p">)</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="n">decoded</span><span class="p">,</span> <span class="n">proba_angle</span> <span class="o">=</span> <span class="n">nap</span><span class="o">.</span><span class="n">decode_1d</span><span class="p">(</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>    <span class="n">tuning_curves</span><span class="o">=</span><span class="n">tuning_curves_adn</span><span class="p">,</span>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>    <span class="n">group</span><span class="o">=</span><span class="n">spikes_adn</span><span class="p">,</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>    <span class="n">ep</span><span class="o">=</span><span class="n">epochs</span><span class="p">[</span><span class="s2">&quot;wake&quot;</span><span class="p">],</span>
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a>    <span class="n">bin_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>  <span class="c1"># second</span>
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a>    <span class="n">feature</span><span class="o">=</span><span class="n">head_direction</span><span class="p">,</span>
</span><span id="__span-26-11"><a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a><span class="p">)</span>
</span><span id="__span-26-12"><a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a><span class="nb">print</span><span class="p">(</span><span class="n">decoded</span><span class="p">)</span>
</span></code></pre></div>
<p class="mkd-glr-script-out">Out:</p>
<div class="language-shell mkd-glr-script-out-disp highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>Time<span class="w"> </span><span class="o">(</span>s<span class="o">)</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="m">600</span>.15<span class="w">     </span><span class="m">2</span>.111562
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="m">600</span>.45<span class="w">     </span><span class="m">2</span>.111562
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="m">600</span>.75<span class="w">     </span><span class="m">2</span>.317568
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="m">601</span>.05<span class="w">     </span><span class="m">2</span>.008559
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="m">601</span>.35<span class="w">     </span><span class="m">2</span>.111562
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="w">             </span>...<span class="w">   </span>
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="m">1198</span>.65<span class="w">    </span><span class="m">4</span>.583635
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="m">1198</span>.95<span class="w">    </span><span class="m">4</span>.274626
</span><span id="__span-27-10"><a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a><span class="m">1199</span>.25<span class="w">    </span><span class="m">4</span>.583635
</span><span id="__span-27-11"><a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a><span class="m">1199</span>.55<span class="w">    </span><span class="m">4</span>.583635
</span><span id="__span-27-12"><a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a><span class="m">1199</span>.85<span class="w">    </span><span class="m">3</span>.862614
</span><span id="__span-27-13"><a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a>Length:<span class="w"> </span><span class="m">2000</span>,<span class="w"> </span>dtype:<span class="w"> </span>float64
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 243-244 -->

<p>We can plot the decoded head-direction along with the true head-direction.</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 244-254 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">head_direction</span><span class="o">.</span><span class="n">as_units</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">decoded</span><span class="o">.</span><span class="n">as_units</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Decoded&quot;</span><span class="p">)</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">)</span>
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Head-direction (rad)&quot;</span><span class="p">)</span>
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<p><img alt="tutorial pynapple quick start" class="mkd-glr-single-img" src="../images/mkd_glr_tutorial_pynapple_quick_start_004.png" srcset="../images/mkd_glr_tutorial_pynapple_quick_start_004.png" /></p>
<!-- GENERATED FROM PYTHON SOURCE LINES 255-261 -->

<hr />
<h2 id="raster">Raster</h2>
<p>Finally we can decode activity during sleep and overlay spiking activity of ADN neurons as a raster plot (in this case only during the first 4 seconds). Pynapple return as well the probability of being in a particular state. We can display it next to the spike train.</p>
<p>First let's decode during sleep with a bin size of 40 ms.</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 261-269 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="n">decoded_sleep</span><span class="p">,</span> <span class="n">proba_angle_Sleep</span> <span class="o">=</span> <span class="n">nap</span><span class="o">.</span><span class="n">decode_1d</span><span class="p">(</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>    <span class="n">tuning_curves</span><span class="o">=</span><span class="n">tuning_curves_adn</span><span class="p">,</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>    <span class="n">group</span><span class="o">=</span><span class="n">spikes_adn</span><span class="p">,</span>
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>    <span class="n">ep</span><span class="o">=</span><span class="n">epochs</span><span class="p">[</span><span class="s2">&quot;sleep&quot;</span><span class="p">],</span>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>    <span class="n">bin_size</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span>  <span class="c1"># second</span>
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>    <span class="n">feature</span><span class="o">=</span><span class="n">head_direction</span><span class="p">,</span>
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a><span class="p">)</span>
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 270-273 -->

<p>Here we are gonna chain the TsGroup function <a href="https://pynapple-org.github.io/pynapple/core.ts_group/#pynapple.core.ts_group.TsGroup.set_info"><code>set_info</code></a> and the function <a href="https://pynapple-org.github.io/pynapple/core.ts_group/#pynapple.core.ts_group.TsGroup.to_tsd"><code>to_tsd</code></a> to flatten the TsGroup and quickly assign to each spikes a corresponding value found in the metadata table. Any columns of the metadata table can be assigned to timestamps in a TsGroup.</p>
<p>Here the value assign to the spikes comes from the preferred firing direction of the neurons. The following line is a quick way to sort the neurons based on their preferred firing direction</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 273-276 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="n">order</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">tuning_curves_adn</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
</span></code></pre></div>
<p class="mkd-glr-script-out">Out:</p>
<div class="language-shell mkd-glr-script-out-disp highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="o">[</span><span class="m">0</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">5</span><span class="o">]</span>
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 277-278 -->

<p>Assigning order as a metadata of TsGroup</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 278-281 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="n">spikes_adn</span><span class="o">.</span><span class="n">set_info</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">spikes_adn</span><span class="p">)</span>
</span></code></pre></div>
<p class="mkd-glr-script-out">Out:</p>
<div class="language-shell mkd-glr-script-out-disp highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="w">  </span>Index<span class="w">    </span>rate<span class="w">  </span>location<span class="w">      </span>group<span class="w">    </span>order
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>-------<span class="w">  </span>------<span class="w">  </span>----------<span class="w">  </span>-------<span class="w">  </span>-------
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a><span class="w">      </span><span class="m">0</span><span class="w">    </span><span class="m">7</span>.3<span class="w">   </span>adn<span class="w">               </span><span class="m">0</span><span class="w">        </span><span class="m">0</span>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="w">      </span><span class="m">1</span><span class="w">    </span><span class="m">5</span>.73<span class="w">  </span>adn<span class="w">               </span><span class="m">0</span><span class="w">        </span><span class="m">4</span>
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a><span class="w">      </span><span class="m">2</span><span class="w">    </span><span class="m">8</span>.12<span class="w">  </span>adn<span class="w">               </span><span class="m">0</span><span class="w">        </span><span class="m">2</span>
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a><span class="w">      </span><span class="m">3</span><span class="w">    </span><span class="m">6</span>.68<span class="w">  </span>adn<span class="w">               </span><span class="m">0</span><span class="w">        </span><span class="m">6</span>
</span><span id="__span-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a><span class="w">      </span><span class="m">4</span><span class="w">   </span><span class="m">10</span>.77<span class="w">  </span>adn<span class="w">               </span><span class="m">0</span><span class="w">        </span><span class="m">1</span>
</span><span id="__span-33-8"><a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a><span class="w">      </span><span class="m">5</span><span class="w">   </span><span class="m">11</span><span class="w">     </span>adn<span class="w">               </span><span class="m">0</span><span class="w">        </span><span class="m">3</span>
</span><span id="__span-33-9"><a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a><span class="w">      </span><span class="m">6</span><span class="w">   </span><span class="m">16</span>.52<span class="w">  </span>adn<span class="w">               </span><span class="m">0</span><span class="w">        </span><span class="m">5</span>
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 282-284 -->

<p>"Flattening" the TsGroup to a Tsd based on <code>order</code>.
It's then very easy to call plot on <code>tsd_adn</code> to display the raster</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 284-287 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="n">tsd_adn</span> <span class="o">=</span> <span class="n">spikes_adn</span><span class="o">.</span><span class="n">to_tsd</span><span class="p">(</span><span class="s2">&quot;order&quot;</span><span class="p">)</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">tsd_adn</span><span class="p">)</span>
</span></code></pre></div>
<p class="mkd-glr-script-out">Out:</p>
<div class="language-shell mkd-glr-script-out-disp highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>Time<span class="w"> </span><span class="o">(</span>s<span class="o">)</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="m">0</span>.00845<span class="w">       </span><span class="m">0</span>.0
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="m">0</span>.03265<span class="w">       </span><span class="m">0</span>.0
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a><span class="m">0</span>.07745<span class="w">       </span><span class="m">6</span>.0
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a><span class="m">0</span>.13230<span class="w">       </span><span class="m">0</span>.0
</span><span id="__span-35-6"><a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a><span class="m">0</span>.14045<span class="w">       </span><span class="m">5</span>.0
</span><span id="__span-35-7"><a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a><span class="w">             </span>...<span class="w"> </span>
</span><span id="__span-35-8"><a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a><span class="m">1199</span>.90650<span class="w">    </span><span class="m">5</span>.0
</span><span id="__span-35-9"><a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a><span class="m">1199</span>.91745<span class="w">    </span><span class="m">5</span>.0
</span><span id="__span-35-10"><a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a><span class="m">1199</span>.94065<span class="w">    </span><span class="m">5</span>.0
</span><span id="__span-35-11"><a id="__codelineno-35-11" name="__codelineno-35-11" href="#__codelineno-35-11"></a><span class="m">1199</span>.95035<span class="w">    </span><span class="m">5</span>.0
</span><span id="__span-35-12"><a id="__codelineno-35-12" name="__codelineno-35-12" href="#__codelineno-35-12"></a><span class="m">1199</span>.96795<span class="w">    </span><span class="m">5</span>.0
</span><span id="__span-35-13"><a id="__codelineno-35-13" name="__codelineno-35-13" href="#__codelineno-35-13"></a>Length:<span class="w"> </span><span class="m">79349</span>,<span class="w"> </span>dtype:<span class="w"> </span>float64
</span></code></pre></div>
<!-- GENERATED FROM PYTHON SOURCE LINES 288-289 -->

<p>Plotting everything</p>
<!-- GENERATED FROM PYTHON SOURCE LINES 289-308 -->

<div class="language-python highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="n">subep</span> <span class="o">=</span> <span class="n">nap</span><span class="o">.</span><span class="n">IntervalSet</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">time_units</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">)</span>
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">19</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
</span><span id="__span-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tsd_adn</span><span class="o">.</span><span class="n">restrict</span><span class="p">(</span><span class="n">subep</span><span class="p">),</span> <span class="s2">&quot;|&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span><span id="__span-36-6"><a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">subep</span><span class="o">.</span><span class="n">start</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">subep</span><span class="o">.</span><span class="n">end</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="__span-36-7"><a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Order&quot;</span><span class="p">)</span>
</span><span id="__span-36-8"><a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Decoding during sleep&quot;</span><span class="p">)</span>
</span><span id="__span-36-9"><a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
</span><span id="__span-36-10"><a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a><span class="n">p</span> <span class="o">=</span> <span class="n">proba_angle_Sleep</span><span class="o">.</span><span class="n">restrict</span><span class="p">(</span><span class="n">subep</span><span class="p">)</span>
</span><span id="__span-36-11"><a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">)</span>
</span><span id="__span-36-12"><a id="__codelineno-36-12" name="__codelineno-36-12" href="#__codelineno-36-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Probability&quot;</span><span class="p">)</span>
</span><span id="__span-36-13"><a id="__codelineno-36-13" name="__codelineno-36-13" href="#__codelineno-36-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">subep</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="__span-36-14"><a id="__codelineno-36-14" name="__codelineno-36-14" href="#__codelineno-36-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;360&quot;</span><span class="p">])</span>
</span><span id="__span-36-15"><a id="__codelineno-36-15" name="__codelineno-36-15" href="#__codelineno-36-15"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="__span-36-16"><a id="__codelineno-36-16" name="__codelineno-36-16" href="#__codelineno-36-16"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">)</span>
</span><span id="__span-36-17"><a id="__codelineno-36-17" name="__codelineno-36-17" href="#__codelineno-36-17"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Head-direction (deg)&quot;</span><span class="p">)</span>
</span><span id="__span-36-18"><a id="__codelineno-36-18" name="__codelineno-36-18" href="#__codelineno-36-18"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="__span-36-19"><a id="__codelineno-36-19" name="__codelineno-36-19" href="#__codelineno-36-19"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<p><img alt="Decoding during sleep, Probability" class="mkd-glr-single-img" src="../images/mkd_glr_tutorial_pynapple_quick_start_005.png" srcset="../images/mkd_glr_tutorial_pynapple_quick_start_005.png" /></p>
<p class="mkd-glr-script-out">Out:</p>
<div class="language-shell mkd-glr-script-out-disp highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>No<span class="w"> </span>artists<span class="w"> </span>with<span class="w"> </span>labels<span class="w"> </span>found<span class="w"> </span>to<span class="w"> </span>put<span class="w"> </span><span class="k">in</span><span class="w"> </span>legend.<span class="w">  </span>Note<span class="w"> </span>that<span class="w"> </span>artists<span class="w"> </span>whose<span class="w"> </span>label<span class="w"> </span>start<span class="w"> </span>with<span class="w"> </span>an<span class="w"> </span>underscore<span class="w"> </span>are<span class="w"> </span>ignored<span class="w"> </span>when<span class="w"> </span>legend<span class="o">()</span><span class="w"> </span>is<span class="w"> </span>called<span class="w"> </span>with<span class="w"> </span>no<span class="w"> </span>argument.
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a>No<span class="w"> </span>artists<span class="w"> </span>with<span class="w"> </span>labels<span class="w"> </span>found<span class="w"> </span>to<span class="w"> </span>put<span class="w"> </span><span class="k">in</span><span class="w"> </span>legend.<span class="w">  </span>Note<span class="w"> </span>that<span class="w"> </span>artists<span class="w"> </span>whose<span class="w"> </span>label<span class="w"> </span>start<span class="w"> </span>with<span class="w"> </span>an<span class="w"> </span>underscore<span class="w"> </span>are<span class="w"> </span>ignored<span class="w"> </span>when<span class="w"> </span>legend<span class="o">()</span><span class="w"> </span>is<span class="w"> </span>called<span class="w"> </span>with<span class="w"> </span>no<span class="w"> </span>argument.
</span></code></pre></div>
<p><strong>Total running time of the script:</strong> ( 0 minutes  5.922 seconds)</p>
<div id="download_links"></div>

<p><a class="md-button center" href="../tutorial_pynapple_quick_start.py"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32v242.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64v-32c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"/></svg></span> Download Python source code: tutorial_pynapple_quick_start.py</a></p>
<p><a class="md-button center" href="../tutorial_pynapple_quick_start.ipynb"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32v242.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64v-32c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"/></svg></span> Download Jupyter notebook: tutorial_pynapple_quick_start.ipynb</a></p>
<p><a class="mkd-glr-signature" href="https://mkdocs-gallery.github.io">Gallery generated by mkdocs-gallery</a></p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.indexes"], "search": "../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.51198bba.min.js"></script>
      
        <script src="../../../javascripts/katex.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>